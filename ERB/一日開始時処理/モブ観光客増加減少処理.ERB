@モブ観光客算出
#DIM 観光客減少補正

;人気度に応じてモブ観光客が増加する
;減少度は雑務ゲージの残量に応じて決定する
VARSET LOCAL

;雑務ゲージ平均値算出
FOR LOCAL, 1, マップ部屋番号上限
	SIF LOCAL == 20
		CONTINUE
	SIF LOCAL > 2000
		CONTINUE
	IF 存在しない移動先_0(LOCAL) == 0
		LOCAL:1 += 雑務ゲージ:LOCAL
		LOCAL:2 += 1
	ENDIF
NEXT
LOCAL:1 = LOCAL:1 / LOCAL:2

;最大雑務ゲージは10000なので、まあ1割未満なら補正なしでいいか……？
;１割を超えるたびに減少補正を増加させる
観光客減少補正 = LOCAL:1 / 1000

;人気度（最大値9999）に応じて観光客量を計算する
モブ観光客数 = リゾート人気度 * (10 - 観光客減少補正) / 10

;増加処理、ついでに乱数を掛ける
IF イベント完了フラグ確認("大拡張！空艇港") > 0
	モブ観光客数 = モブ観光客数 * 12 / 10
ENDIF
IF 高速船記録:派遣先登録 == "ポート・ブリーズ群島" && 高速船記録:派遣状態 == "派遣中"
	モブ観光客数 = モブ観光客数 * 12 / 10
ENDIF
IF 施設改造度:7:3
	モブ観光客数 += 10
ENDIF
モブ観光客数 = モブ観光客数 * RAND(95, 106) / 100

