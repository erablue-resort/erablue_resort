;Ver0.102と旧バージョンとの互換のための処理
;Ver0.105にしたとき消す、互換を103に

;追加TALENT、追加CSTRのチェック
@VERUP_102_CHARA(ARG)

IF 疑似恋慕_恋慕枠フォロー == 0
	IF TALENT:ARG:恋慕 > 0 && MATCH(恋慕対象フラグ, ARG) < 1
		FOR LOCAL, 0, CHARANUM
			IF !恋慕対象フラグ:LOCAL
				恋慕対象フラグ:LOCAL = ARG
				BREAK
			ENDIF
		NEXT
	ENDIF
ENDIF

;その他広域変数の書き換えなど
@VERUP_102()

; IF なんらかフォロー == 0
; 	;なんらかのフォロー処理
; 	;ここで"なんらかフォロー = 1"しない
; ENDIF

IF 舞踏会フォロー == 0
	FOR LOCAL, 0, DT_ROW_LENGTH("各イベント用変数配列")
		IF DT_CELL_GETS("各イベント用変数配列", LOCAL, "イベント名") == "『舞踏会』への招待"
			;まだ発生してないなら大丈夫
			SIF DT_CELL_GET("各イベント用変数配列", LOCAL, "イベント発生フラグ") == 0
				BREAK
			;再発生が入ってないなら入れる
			IF DT_CELL_GET("各イベント用変数配列", LOCAL, "イベント再発生確率") == 0
				イベント再発生日数渡し = 0
				イベント再発生確率渡し = 0
				CALL イベント発生条件_突発イベント_『舞踏会』への招待()
				DT_CELL_SET "各イベント用変数配列", LOCAL, "イベント再発生CT", イベント再発生日数渡し
				DT_CELL_SET "各イベント用変数配列", LOCAL, "イベント再発生確率", イベント再発生確率渡し
			ENDIF
		ENDIF
		BREAK
	NEXT
ENDIF

IF サブリナフォロー == 0
	CFLAG:(GETCHARA(403)):恋慕不可_汎用解除禁止 = 0
	CFLAG:(GETCHARA(403)):セフレ不可_汎用解除禁止 = 0
ENDIF

;対応処理用フラグを対応済状態にセット
@VERUP_102_FINISH()
; なんらかフォロー = 1

疑似恋慕_恋慕枠フォロー = 1
舞踏会フォロー = 1
サブリナフォロー = 1
