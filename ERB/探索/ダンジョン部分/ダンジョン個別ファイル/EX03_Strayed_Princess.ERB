

@ダンジョン初期処理_Strayed_Princess
;ダンジョン構造の読み込み
;0でない時、そのマスは存在する
#DIM 深度
#DIM 分岐

ダンジョンサブタイトル = 迷い込んだ小公女
ダンジョンマス画像URL_伏せ状態 = 壁_森
ダンジョン現在位置:0 = 3
ダンジョン現在位置:1 = 7
ダンジョン背景画像 = 背景_森

;スタート地点は必ず存在
;初期からオープン済みなので3を入れる
;ビット0：存在するか　ビット1：移動できるか　ビット2：マスをオープンするか（ビット１をONにしないと無意味）　ビット3：入れないがオープンする場合に使用
;ビット4以降：自由枠。主に宝箱の開閉やイベント達成フラグなどに使用
IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}") == 0
	SETVAR @"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}", 3
ENDIF

FOR 深度, 1, 100
	LOCAL = 0
	FOR 分岐, 0, 9
		IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{深度}:{分岐}")
			;既にマス情報が入ってるなら飛ばす
			LOCAL = 1
			CONTINUE
		ELSEIF ENUMFUNCBEGINSWITH(@"ダンジョンマス情報_%ダンジョン名%_{深度}_{分岐}")
			LOCAL = 1
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:深度:分岐", 1
		ENDIF
	NEXT
	IF LOCAL
		ダンジョン最大深度 = 深度
	ENDIF
NEXT

@ダンジョン解説文_Strayed_Princess

詳細文文字列受け渡し変数 = 
詳細文文字列受け渡し変数 += "山中に謎の馬らしき生物を連れた野盗が現れた。<br>"
詳細文文字列受け渡し変数 += "放置していれば、リゾート島の環境や客に大きな被害を与えるだろう。<br>"
詳細文文字列受け渡し変数 += @"%CALLNAME:PLAYER%は野盗討伐のため、山中へと赴く。<br>"
詳細文文字列受け渡し変数 += "<br>"
詳細文文字列受け渡し変数 += "ダンジョン出典：Violated Princess<br>"
詳細文文字列受け渡し変数 += "<br>"
詳細文文字列受け渡し変数 += "<br>"
詳細文文字列受け渡し変数 += "※本ダンジョンでは、敗北時にエロイベント等は発生しません。"

;推奨レベルを返す
RETURN 10

@敵討伐後処理_ダンジョン固有_Strayed_Princess(討伐エネミー数)
#DIM 討伐エネミー数
;ダンジョン内で戦闘した後に呼ばれる関数、主にダンジョンごとのドロップアイテム取得に使用
;今回アイテムドロップはないので記述なし

;---------------------------------------------------------------------
;マップ構造
;---------------------------------------------------------------------
;イベントミニマップなのでほぼ一本道、途中ちょっとだけ分岐
;---------------------------------------------------------------------

@ダンジョンマス情報_Strayed_Princess_3_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "3_4")
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 木々が鬱蒼と生い茂っている。
			CALL 再視聴確認(1)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			WSTR:(K++) = %CALLNAME:PLAYER%は野盗の船が降りた山へと足を踏み入れた。
			WSTR:(K++) = 鬱蒼と生い茂る森の中では、いつ野盗たちと鉢合わせになるか分からない。気を付けて進もう。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 1)
			;戦闘部分
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_3_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "3_2")
	CASE "マスイベント"
		KSTR:(K++) = 地面に人の小さな足跡がある。子供のものだろうか。
		KSTR:(K++) = 何も知らないリゾート客が先に進んでいるとしたら面倒だ。先を急ごう。
		CALL 接続ルート全開放処理(マス深度, マス分岐)
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_3_2(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "3_0")
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 野盗と戦った場所だ。
			CALL 再視聴確認(0)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			;立ち絵リソース記録に必要な画像のリソースを生成する
			CALLF 顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),100,,,1,1)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗",101)
			LOCALS:1 = %立ち絵リソース記録%
			WSTR:(K++) = 森の奥へと進んでいると、木々の間から野盗と思われる複数の男達が見える。
			WSTR:(K++) = 何かを探しているのか、辺りをキョロキョロと見わたしているが……
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「ああ？ なんだてめぇら！？ あのガキの仲間か！？」
			CALL メッセージ欄表示用関数(LOCALS:1,"野盗",,0)
			CALL 口上変数初期化
			WSTR:(K++) = どうやら、向こうもこちらの存在に気が付いたようだ。
			WSTR:(K++) = 野盗がナイフを片手に%CALLNAME:PLAYER%たちに襲い掛かってきた！
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 1)
			;戦闘部分
			敵BATTLE_STATE_STR:0:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:3:エネミー名 = Lv10_野盗
			CALL 雑魚敵遭遇汎用処理
			IF RESULT != 0 && GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
				CALL マス未踏破戻し処理(ダンジョン現在位置:0, ダンジョン現在位置:1)
				ダンジョン現在位置:0 = 3
				ダンジョン現在位置:1 = 4
				RETURN 0
			ENDIF
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			;勝利後or読み返し中
			WSTR:(K++) = 野盗を退けた。
			WSTR:(K++) = 『あのガキ』という言葉からして、やはり先程の足跡はリゾート客のものだろうか…？
			WSTR:(K++) = ともあれ、先を急いだ方が良さそうだ。
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			LOCAL = GETVAR(@"ダンジョン構造配列_%ダンジョン名%:3:0")
			SETBIT LOCAL, 1
			SETBIT LOCAL, 2
			CLEARBIT LOCAL, 3
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:3:0", LOCAL
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_3_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 上アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 11
		ダンジョン現在位置:1 = 7
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 接続ルート全開放処理(11, 7)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_11_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 下アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "11_5")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 3
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_11_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "11_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 男達の怒声が聞こえる…
			WSTR:(K++) = 先程の野盗の仲間だろう。%CALLNAME:PLAYER%達は声のする方向へと足を向けた。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 人の足跡が複数残っている。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT




@ダンジョンマス情報_Strayed_Princess_11_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "11_0")
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 野盗とセレナが戦っていた場所だ。
			CALL 再視聴確認(0)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",102,,,"暗闇掛け")
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗",103)
			LOCALS:1 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗1",104,,,"怒りマーク")
			LOCALS:2 = %立ち絵リソース記録%
			WSTR:(K++) = これは戦闘音だろうか？ 男達の怒声に混じって、何かが衝突するような音が聞こえてきた。
			WSTR:(K++) = もしかしたらリゾート客ではなく、野盗の討伐に来た騎空士か何かかもしれない。近付いてみよう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「クソがっ！ こんなガキ1匹に何手間取ってやがる！ 何モンだてめえ！」
			CALL メッセージ欄表示用関数(LOCALS:1,"野盗A",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「名乗ったところで貴様らには分かるまい。要件も……言う必要は無いな」
			CALL メッセージ欄表示用関数(LOCALS,"金髪の少女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「気取ったクソガキがっ！ 後悔してももう遅えぞ！！」
			CALL メッセージ欄表示用関数(LOCALS:2,"野盗B",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 近付いてみると、1人の金髪の少女が複数の野盗と対峙して戦っていた。
			WSTR:(K++) = 少女が拳を振るう度、野盗の体が宙を舞っている。魔力を飛ばしているのだろうか？
			WSTR:(K++) = 野盗が振り回すナイフに対しても、軽快なステップでツインテールをしっぽのように揺らしながら躱している。
			WSTR:(K++) = とはいえ、野盗の数が多い。少女に加勢するべきだろう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「今度はなんだぁ！？」
			CALL メッセージ欄表示用関数(LOCALS:1,"野盗A",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「む……！？」
			CALL メッセージ欄表示用関数(LOCALS,"金髪の少女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = %CALLNAME:PLAYER%たちは野盗へと攻め掛かった！
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 1)
			;戦闘部分
			敵BATTLE_STATE_STR:0:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:3:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:4:エネミー名 = Lv10_野盗
			CALL 雑魚敵遭遇汎用処理
			IF RESULT != 0 && GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
				CALL マス未踏破戻し処理(ダンジョン現在位置:0, ダンジョン現在位置:1)
				ダンジョン現在位置:0 = 11
				ダンジョン現在位置:1 = 5
				RETURN 0
			ENDIF
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",105,,,"暗闇掛け")
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",106)
			LOCALS:1 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_驚き",107)
			LOCALS:2 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_悲しみ",108)
			LOCALS:3 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_目瞑り",109)
			LOCALS:4 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_苦笑",110)
			LOCALS:5 = %立ち絵リソース記録%
			WSTR:(K++) = 「すまない、助かった」
			CALL メッセージ欄表示用関数(LOCALS,"金髪の少女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 野盗を蹴散らした後、金髪の少女がこちらに近付き声をかけてきた。
			WSTR:(K++) = 少女の姿を改めて見るが、非常に小柄である。ドラフ族の女性と同じくらいの身長だ。
			WSTR:(K++) = ひとまず、%CALLNAME:PLAYER%は彼女に自己紹介をすることにした。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「この島を管理しているオーナー殿か。挨拶が遅れた」
			CALL メッセージ欄表示用関数(LOCALS,"金髪の少女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「私はセレナ・フオ……セレナだ。よろしく頼む」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = セレナと名乗る少女に、野盗の討伐に来た旨を説明する。
			WSTR:(K++) = 静かに話を聞くセレナだが、野盗が謎の一角獣を連れている話を聞くと、目を見開いて狼狽えた。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「その話は誠か！？」
			CALL メッセージ欄表示用関数(LOCALS:2,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　……っ、すまない。見苦しい姿を見せてしまった」
			CALL メッセージ欄表示用関数(LOCALS:3,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 薄々察していたが、やはり訳アリらしい。
			WSTR:(K++) = %CALLNAME:PLAYER%は何故ここにいるのかを聞くことにした。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「オーナー殿には話をするべきか。
			WSTR:(K++) = 　実は、とある理由でユニコーンを探している」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = セレナの説明によると、家で飼っていたユニコーンの子供が何者かに攫われたらしい。
			WSTR:(K++) = 単身飛び出した彼女は、噂やわずかな痕跡等を伝ってこの島に連れ込まれた情報を得て、ここまで追跡したとのことだ。
			WSTR:(K++) = しかし、この件は使用人なり騎空士なりに任せるべきではないだろうか。
			WSTR:(K++) = 洗練された立ち振る舞いに、大事に磨かれたのが一目で分かる容貌。彼女は間違いなく、『使う側』の存在だ。
			WSTR:(K++) = おそらく両親もセレナが１人でユニコーンを追って家を出るのを承知していないだろう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「オーナー殿の言う事はまったくもって正しい。私自身、そうすべきと思う。
			WSTR:(K++) = 　誰が聞いても、馬鹿な事をしていると言うだろう。
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　だが、あの子は……スプレンドールは私にとって唯一無二の、たった１人の友達なのだ。
			WSTR:(K++) = 　私の知らない場所で恐ろしい、酷い目に遭わされていると思うと……」
			CALL メッセージ欄表示用関数(LOCALS:3,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 悲壮な表情をしながら説明をするセレナ。
			WSTR:(K++) = しかし、野盗はセレナの事情を汲んだりはしない。仮に捕まれば、セレナ程の少女なら死よりも辛い責苦を味わうだろう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「それを覚悟の上だ。きっとこの瞬間も、あの子は私を呼んでいるに違いない。
			WSTR:(K++) = 　その声に応えるために、私は今ここにいる。
			WSTR:(K++) = 　この判断がどんなに愚かしく不合理でも。どんなに間違っていても。
			CALL メッセージ欄表示用関数(LOCALS:4,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　私は、私の選択を支持するだろう」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = そう言い切ると、決意を秘めた表情をするセレナ。おそらく、何を言っても一歩も引かないだろう。
			WSTR:(K++) = それにセレナを放置した結果、彼女が野盗に陵辱されるようなことになれば寝覚めが悪い。
			WSTR:(K++) = %CALLNAME:PLAYER%は野盗の討伐を共に行わないかと提案した。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「私と我が家の問題ゆえ、余人を関わらせるつもりはない。
			CALL メッセージ欄表示用関数(LOCALS:4,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　と言いたいところだが、島を荒らす野盗の存在はオーナー殿にとっても他人事ではない。
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　……実を言えば、家を出てから１人で心細かったのだ。
			WSTR:(K++) = 　助けてくれるというのなら、これ以上有難いことはない。よろしく頼む、オーナー殿」
			CALL メッセージ欄表示用関数(LOCALS:5,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 話は決まりだ。
			WSTR:(K++) = %CALLNAME:PLAYER%とセレナは、野盗たちの足跡を追って歩みを進め始めた。
			
			
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			LOCAL = GETVAR(@"ダンジョン構造配列_%ダンジョン名%:11:0")
			SETBIT LOCAL, 1
			SETBIT LOCAL, 2
			CLEARBIT LOCAL, 3
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:11:0", LOCAL
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_11_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 上アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 19
		ダンジョン現在位置:1 = 7
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 接続ルート全開放処理(19, 7)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_19_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 下アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_5")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 11
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_19_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",111)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_笑顔",112)
			LOCALS:1 = %立ち絵リソース記録%
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「スプレンドールのことを聞きたい？ そうだな……
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　あの子は私手づからでないとニンジン１本食べないし、私が撫でて寝付かせないと一晩中鳴くのだ。
			WSTR:(K++) = 　私がピアノを弾いていると隣で飛び跳ね、私が叱られ泣いていると、あの子は隣にいてくれて――」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = セレナは柔らかな笑顔でユニコーンについて話をしている。
			WSTR:(K++) = 先程までの堂々とした佇まいとは打って変わり、年相応の可愛らしい少女の姿がそこにあった。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 人の足跡が複数残っている。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_19_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 19
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "19_0")
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 野盗と戦った場所だ。
			CALL 再視聴確認(0)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",113)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_悲しみ",114)
			LOCALS:1 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_怒り",115)
			LOCALS:2 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗",116)
			LOCALS:3 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗1",117)
			LOCALS:4 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗2",118)
			LOCALS:5 = %立ち絵リソース記録%
			WSTR:(K++) = セレナと雑談しながら先を進んでいると、野盗の一団が現れた。
			WSTR:(K++) = 既に%CALLNAME:PLAYER%たちが野盗を倒して回っている情報は伝わっているのか、武器を構えて殺気立っている。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「舐めた真似してくれるじゃねえか……生きて帰れると思うなテメエら！」
			CALL メッセージ欄表示用関数(LOCALS:3,"野盗A",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「待てよ、よく見ればツラの良いメスばかりじゃねえか。
			WSTR:(K++) = 　ヤリ放題の便器として並べて犯してやろうぜ」
			CALL メッセージ欄表示用関数(LOCALS:4,"野盗B",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「そりゃいい！ 俺はあの金髪のガキとヤリてえ！
			WSTR:(K++) = 　面白みのねえ体だが、カスの種で孕ませてやらぁ！
			WSTR:(K++) = 　今までの便器は最高で『3匹』だったか？」
			CALL メッセージ欄表示用関数(LOCALS:5,"野盗C",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「バーカ、あんなチビじゃ1匹産んだら壊れちまうよ。
			WSTR:(K++) = 　ま、壊れたら壊れたで良い見せしめにはなるがな。ギャハハハハ！！」
			CALL メッセージ欄表示用関数(LOCALS:3,"野盗A",,0)
			CALL 口上変数初期化
			;男やケモオンリーのパーティーだと野盗の台詞が矛盾するか野盗が特殊性癖になるけどまあいいか！よろしくなあ！
			WSTR:(K++) = 野盗は下劣な言葉を吐きながら下品な笑い声を上げている。
			WSTR:(K++) = セレナも眉を顰め、冷ややかな目を野盗に向けていた。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「聞くに堪えないな。
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　行くぞ、オーナー殿！」
			CALL メッセージ欄表示用関数(LOCALS:2,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = %CALLNAME:PLAYER%たちは野盗へと攻め掛かった！
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 1)
			;戦闘部分
			敵BATTLE_STATE_STR:0:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:3:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:4:エネミー名 = Lv10_野盗
			敵BATTLE_STATE_STR:7:エネミー名 = Lv10_野盗
			CALL 雑魚敵遭遇汎用処理
			IF RESULT != 0 && GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
				CALL マス未踏破戻し処理(ダンジョン現在位置:0, ダンジョン現在位置:1)
				ダンジョン現在位置:0 = 19
				ダンジョン現在位置:1 = 5
				RETURN 0
			ENDIF
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_笑顔",119)
			LOCALS = %立ち絵リソース記録%
			WSTR:(K++) = 野盗を倒した。セレナにも特に怪我は無いようだ。
			WSTR:(K++) = 少女が聞くには精神的にキツそうな言葉を吐かれたにも関わらず、特に堪えた様子は無さそうである。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「ああ、私のことは心配しなくても大丈夫だ。
			WSTR:(K++) = 　私は赤子というものは愛と幸せによって生まれてくるものだと先日この目で確かめた。
			WSTR:(K++) = 　あの程度の雑言、気にするまでも無い」
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = ……どうやら、セレナは性に関してはほぼ無知な上にかなり知識が偏っているようだ。
			WSTR:(K++) = 幼いとはいえ、王侯貴族と思われる彼女の実家の性教育はどうなっているのだろうか。
			WSTR:(K++) = 若干のもやもやを抱えたまま、%CALLNAME:PLAYER%は先に進むことにした。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			LOCAL = GETVAR(@"ダンジョン構造配列_%ダンジョン名%:19:0")
			SETBIT LOCAL, 1
			SETBIT LOCAL, 2
			CLEARBIT LOCAL, 3
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:19:0", LOCAL
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_19_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 上アイコン
	CASE "接続先"
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 27
		ダンジョン現在位置:1 = 7
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 接続ルート全開放処理(27, 7)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_27_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 下アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_5")
	CASE "マスイベント"
		;移動先Yと移動先Yを、移動先の位置に変更すること
		ダンジョン現在位置:0 = 19
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_Strayed_Princess_27_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_笑顔",120)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_悲しみ",121)
			LOCALS:1 = %立ち絵リソース記録%
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「リゾートには湯浴みや泳ぐための施設があるのだな。
			WSTR:(K++) = 　私は今回初めて家から出た故、少し興味がある。
			WSTR:(K++) = 　ちなみに、着替えでは家人は幾人つく？」
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　――そ、そうか。１人で行うのが普通か。変なことを聞いてしまった」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = セレナは筋金入りの箱入りお嬢様のようだ。今回の件が片付いたら、リゾートに招待してもいいかもしれない。
			WSTR:(K++) = 少し気が緩んでしまったが、そろそろ野盗のボスが出てくるかもしれない。%CALLNAME:PLAYER%は気合を入れ直した。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 人の足跡が複数残っている。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_Strayed_Princess_27_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_1")
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 野盗のボスと戦った場所だ。
			CALL 再視聴確認(0)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			;立ち絵リソース記録に必要な画像のリソースを生成する
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_怒り",122)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",123)
			LOCALS:1 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_野盗ボス",124)
			LOCALS:2 = %立ち絵リソース記録%
			WSTR:(K++) = 先を進んでいると、森の開けた場所にたどり着いた。
			WSTR:(K++) = 広場の中央には色黒の男と横になっている小さな一角獣がいる。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「スプレンドール！」
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「……透き通った金髪に白い肌。ふん、なるほど？」
			WSTR:(K++) = 　お前らが俺に喧嘩を売ってきたとかいう連中か」
			CALL メッセージ欄表示用関数(LOCALS:2,"野盗のボス",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「……自分の都合でしか物を見ない男だ。スプレンドールに何をした！」
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「騒々しいガキだな。
			WSTR:(K++) = 　暴れるから薬で少し眠ってるだけだ。売り物でなければとっとと殺処分したいくらいだ……まあいい」
			CALL メッセージ欄表示用関数(LOCALS:2,"野盗のボス",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 男の口ぶりからして、コイツが野盗のボスだろう。
			WSTR:(K++) = ユニコーンを取引するためか、あるいは休息の為にこの島に降りてきたのだろうか。傍迷惑な話である。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「使えない部下を始末したことはどうでもいいが、お前らの行いは俺への宣戦布告と受け取った。
			WSTR:(K++) = 　お前は華奢な身体をしているが、口直しにはそれもいいだろう。
			WSTR:(K++) = 　男は死んで、女は俺のガキを孕んでいけ」
			CALL メッセージ欄表示用関数(LOCALS:2,"野盗のボス",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 無許可でこの島に着陸した上に、無茶苦茶しか言わない男だ。盛り上がった股間が非常に気持ち悪い。
			WSTR:(K++) = この男はここで仕留めなければ、リゾートにとって大きな災いをもたらすだろう。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「ふん、どこまでも自分の都合しか口にしない男だ。
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　よかろう、謙虚であることが何故美徳とされるのか、貴様の五体に教育してやる」
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = %CALLNAME:PLAYER%たちは野盗のボスへと攻め掛かった！
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化

		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 1)
			;戦闘部分
			敵BATTLE_STATE_STR:0:エネミー名 = Lv15_野盗のボス
			CALL 雑魚敵遭遇汎用処理
			IF RESULT != 0 && GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
				CALL マス未踏破戻し処理(ダンジョン現在位置:0, ダンジョン現在位置:1)
				ダンジョン現在位置:0 = 27
				ダンジョン現在位置:1 = 5
				RETURN 0
			ENDIF
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT







@ダンジョンマス情報_Strayed_Princess_27_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原

		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
	CASE "マスイベント"
		RFLAG:ダンジョン再視聴フラグ = 0
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			SETBIT RFLAG:ダンジョン再視聴フラグ, 0
			SETBIT RFLAG:ダンジョン再視聴フラグ, 1
			SETBIT RFLAG:ダンジョン再視聴フラグ, 10
		ELSE
			KSTR:(K++) = 問題を解決し、新たなリゾートの顧客を獲得した。
			CALL 再視聴確認(1)
		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 0)
			;立ち絵リソース記録に必要な画像のリソースを生成する
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_涙",125)
			LOCALS = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_涙1",126)
			LOCALS:1 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_笑顔",127)
			LOCALS:2 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_悲しみ",128)
			LOCALS:3 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_基本",129)
			LOCALS:4 = %立ち絵リソース記録%
			CALLF 任意顔グラ表示用文字列関数(キャラ検索("[グラツィア大公家の小公女]セレナ"),"ダンジョン用_苦笑",130)
			LOCALS:5 = %立ち絵リソース記録%
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 野盗のボスを倒した。辺りを見渡すと、セレナは倒れているユニコーンの傍に駆け寄っている。
			WSTR:(K++) = セレナが心配そうに何度かユニコーンを撫でると、ユニコーンの目がゆっくりと開かれた。
			WSTR:(K++) = 傍にいるのが己の本来の飼い主と認識したのか、ユニコーンは小さな声で嘶き、セレナに甘えるように体を寄せている。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「ああ、スプレンドール……スプレンドール……！
			CALL メッセージ欄表示用関数(LOCALS,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　やっと、やっと会えた……我が輝き……！」
			CALL メッセージ欄表示用関数(LOCALS:1,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = セレナは涙を流しながらユニコーンに抱き着いている。
			WSTR:(K++) = 感動の再会を邪魔しないように無言で暫し見つめていると、セレナがこちらに向き直った。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「ありがとう、オーナー殿。
			WSTR:(K++) = 　そなたの力添えのお陰で、こうしてスプレンドールと再会することが出来た」
			CALL メッセージ欄表示用関数(LOCALS:2,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = こちらに謝意を伝えるセレナだが、見たところまだ問題は残っている。
			WSTR:(K++) = 野盗の管理が雑だったのか、あるいは慣れない環境で精神的に参ったのか、ユニコーンが衰弱しているように見える。
			WSTR:(K++) = すぐに騎空艇に乗せて長旅をさせるのは危険かもしれない。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「確かに、家にいた時に比べて瘦せ細っている。
			WSTR:(K++) = 　療養させる必要がある、か」
			CALL メッセージ欄表示用関数(LOCALS:3,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = そこで、%CALLNAME:PLAYER%はユニコーンをしばらくリゾートで療養させないか提案をした。
			WSTR:(K++) = リゾートは各国の王族も御用達なので、療養には最高の環境だろう。
			WSTR:(K++) = 純潔の乙女にしか懐かないという問題も、eraの力があればなんとかなる筈だ。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「私としては願ってもない提案だが、本当に良いのか？」
			CALL メッセージ欄表示用関数(LOCALS:4,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 本能に訴えかける無意識の魅力を持つセレナと、彼女の実家に恩を売るのは悪くない。
			WSTR:(K++) = そんな下心込みの提案だが、純粋無垢な彼女はそこまで見抜くことはできなかったようだ。
			WSTR:(K++) = セレナは苦笑を浮かべ、こちらの顔を見つめている。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「……この島に来てから世話になってばかりだ。その好意には素直に例を言おう。
			CALL メッセージ欄表示用関数(LOCALS:5,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 　これからもよろしく頼む、オーナー殿」
			CALL メッセージ欄表示用関数(LOCALS:2,"セレナ",,0)
			CALL 口上変数初期化
			WSTR:(K++) = なにはともあれ、野盗問題は一件落着だ。
			WSTR:(K++) = さしあたり、ユニコーンの飼い方について詳しく調べる必要があるだろう。
			WSTR:(K++) = %CALLNAME:PLAYER%はユニコーンの世話の仕方について、セレナに聞きながら来た道を戻り始めた……
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = [グラツィア大公家の小公女]セレナがリゾートを訪れるようになった！

		ENDIF
		IF GETBIT(RFLAG:ダンジョン再視聴フラグ, 10)
			;再視聴では通らない報酬部分
			CFLAG:(キャラ検索("[グラツィア大公家の小公女]セレナ")):招待不可フラグ = 0
			
			;再視聴では通らない報酬部分
			CFLAG:(キャラ検索("[グラツィア大公家の小公女]セレナ")):招待不可フラグ = 0

			IF 滞在キャラ上限 - 滞在キャラ数 - 集客人数 - FLAG:滞在キャラ枠先確保分 > 0
				解放キャラ招待:(FINDELEMENT(解放キャラ招待, 0)) = キャラ検索("[グラツィア大公家の小公女]セレナ")
				FLAG:滞在キャラ枠先確保分 += 1
			ENDIF
			ダンジョン終了状況 = 踏破達成
			ダンジョンクリアフラグ_Strayed_Princess = 1
		ENDIF
		RFLAG:ダンジョン再視聴フラグ = 0
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

