;特定のキャラをメインにするイベントカテゴリ
;YYYYを任意のイベント名に変えて使うこと、他との重複不可

@イベント発生条件_キャライベント_毒牙にかかった花
#DIM 対象キャラ
対象キャラ = キャラ検索("[浄化の姉妹・支援担当]ハーニャ")
;開放条件を満たしたら1を返すこと
;ハーニャの状態をチェック
SIF CSTR:対象キャラ:固有素質0 == "失われた加護"
	RETURN 0
SIF TALENT:対象キャラ:妊娠不可 == 0
	RETURN 0
;正規のイベントで恋慕不可が解除されていたら発生しない
SIF イベント完了フラグ確認(@"【汎用】[浄化の姉妹・支援担当]ハーニャ[恋慕不可]解除") == 1
	RETURN 0
;ハーニャが滞在している
SIF CFLAG:対象キャラ:滞在期間 < 1
	RETURN 0
;リーリアの状態をチェック（不妊の加護の時はまだ落ちていない）
対象キャラ = キャラ検索("[浄化の姉妹・戦闘担当]リーリア")
SIF CSTR:対象キャラ:固有素質0 == "不妊の加護"
	RETURN 0
SIF CFLAG:対象キャラ:滞在期間 < 1
	RETURN 0
RETURN 1

@イベント消滅条件_キャライベント_毒牙にかかった花
;この条件を満たした時、イベントは発生してない扱いとなる
;発生条件＞消滅条件で見るので、発生と消滅を両方満たしている時は「発生した！」というメッセージが出るが発生していない扱いになる
;そのため条件には注意すること
#DIM 対象キャラ
対象キャラ = キャラ検索("[浄化の姉妹・支援担当]ハーニャ")
;消滅条件を満たしたら1を返す
;正規の恋慕不可解除イベントが実行されたら消滅させる
SIF イベント完了フラグ確認(@"【汎用】[浄化の姉妹・支援担当]ハーニャ[恋慕不可]解除") == 1
	RETURN 1
;加護が消えたら消滅する
SIF CSTR:対象キャラ:固有素質0 == "失われた加護"
	RETURN 1
RETURN 0

@イベント関数_キャライベント_毒牙にかかった花(ARG)
#DIM 対象キャラ
DRAWLINE
PRINTL ［毒牙にかかった花］
DRAWLINE
PRINTW
PRINTFORMW 先だってリーリアの不妊の加護が失われた。
PRINTFORMW 同じ「浄化の姉妹」であるハーニャの加護も剥がすことはできないだろうか？
PRINTFORMW そう考えたものの、彼女はなかなかお堅い…。
PRINTFORMW そこで、一計を案じることにした。
PRINTFORMW 
PRINTFORMW リーリアに『お願い』し、ハーニャを誘って3人で飲みかわす。
PRINTFORMW リーリアが%CALLNAME:PLAYER%と歓談していることで次第にハーニャの警戒が解けていく。
PRINTFORMW 酔いに合わせてeraの力を強く強くハーニャに向ける。
PRINTFORMW 肩に触れ、言葉を尽くし、腰に手を回し、堅い殻をこじ開ける…。
PRINTFORMW 
PRINTFORMW 星晶獣eraのお膝元、リーリアと同様、ほんの一時そう思わせるだけで十分だった。
PRINTFORMW 
PRINTFORMW 
PRINTFORMW ハーニャの不妊の加護が失われた。
PRINTFORMW 
;イベント中にアイテムやステータスの変動が起こる場合、以下の分岐の中に記述すること
;イベント再視聴で無限に稼ぎが出来たりしないようにする措置
IF !FLAG:クリア済み視聴フラグ
	対象キャラ = キャラ検索("[浄化の姉妹・支援担当]ハーニャ")
	CSTR:対象キャラ:固有素質0 = 失われた加護
	TALENT:対象キャラ:陥落不可 = 0
	TALENT:対象キャラ:妊娠不可 = 0
	CALL イベント完了フラグ汎用処理_再視聴不可(@"【汎用】%NAME:対象キャラ%[恋慕不可]解除")
ENDIF

CALL イベント完了フラグ汎用処理("毒牙にかかった花")
