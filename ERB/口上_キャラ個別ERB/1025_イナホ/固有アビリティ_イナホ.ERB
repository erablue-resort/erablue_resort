
@固有アビ_1025_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 50
	アビ名 = 百鬼夜行++
	消費ＭＰ = 150
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = 百鬼夜行+
	消費ＭＰ = 150
ELSE
	アビ名 = 百鬼夜行
	消費ＭＰ = 200
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に［耐久250］バリア効果［3ターン］
		詳細文文字列受け渡し変数 += @"<br>対象に［10％］追撃効果［3ターン］"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 50
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に［耐久500］バリア効果［3ターン］
			詳細文文字列受け渡し変数 += @"<br>対象に［30％］追撃効果［3ターン］"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = バリア
		アビ汎用文字列:バフ・デバフ対象能力 = バリア
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 50
			アビ汎用変数:効果量 = 500
		ELSE
			アビ汎用変数:効果量 = 250
		ENDIF
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 追撃_アビA枠
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 50
			アビ汎用変数:効果割合 = 30
		ELSE
			アビ汎用変数:効果割合 = 10
		ENDIF
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT



@固有アビ_1025_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
	アビ名 = 夢幻・殺生陣
	消費ＭＰ = 200
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = 殺生陣+
	消費ＭＰ = 200
ELSE
	アビ名 = 殺生陣
	消費ＭＰ = 250
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に3回光属性［攻撃力×150％］ダメージ
		詳細文文字列受け渡し変数 += @"<br>対象に恐怖効果［3ターン］"
		詳細文文字列受け渡し変数 += @"<br>対象に感電効果［5ターン/回復不可］"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に3回光属性［攻撃力×200％］ダメージ
			詳細文文字列受け渡し変数 += @"<br>対象に恐怖効果［3ターン］"
			詳細文文字列受け渡し変数 += @"<br>対象に感電効果［5ターン/回復不可］"
			詳細文文字列受け渡し変数 += @"<br>対象に与ダメージ［100］減少効果［3ターン］"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
			アビ汎用変数:効果割合 = 150
		ELSE
			アビ汎用変数:効果割合 = 200
		ENDIF
		FOR LOCAL, 0, 3
			CALL アビテンプレート_ダメージ処理_光属性
		NEXT
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 恐怖
		アビ汎用文字列:バフ・デバフ対象能力 = 恐怖
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 感電
		アビ汎用文字列:バフ・デバフ対象能力 = 連続攻撃率
		アビ汎用変数:効果割合 = 2
		アビ汎用変数:累積上限_割合 = 20
		アビ汎用変数:持続ターン = 5
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 与ダメージ減少
			アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
			アビ汎用変数:効果量 = 100
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_不利効果_デバフ効果セット
		ENDIF
ENDSELECT



@固有アビ_1025_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
	アビ名 = 九尾の神速+
	消費ＭＰ = 150
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = 九尾の神速
	消費ＭＰ = 150
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に九尾の神速効果［3ターン/消去不可］
		詳細文文字列受け渡し変数 += @"<br>◆このアビリティは行動回数を消費しない"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 九尾の神速
		アビ汎用文字列:バフ・デバフ対象能力 = 九尾の神速
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		;以下付随バフ
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_DA率
			アビ汎用文字列:バフ・デバフ対象能力 = DA率
			アビ汎用変数:効果量 = 100
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_TA率
			アビ汎用文字列:バフ・デバフ対象能力 = TA率
			アビ汎用変数:効果量 = 50
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_高揚
			アビ汎用文字列:バフ・デバフ対象能力 = 高揚
			アビ汎用変数:効果量 = 10
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_与ダメ上昇
			アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
			アビ汎用変数:効果割合 = 5
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
		ELSE
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_DA率
			アビ汎用文字列:バフ・デバフ対象能力 = DA率
			アビ汎用変数:効果量 = 50
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_TA率
			アビ汎用文字列:バフ・デバフ対象能力 = TA率
			アビ汎用変数:効果量 = 25
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 九尾の神速_高揚
			アビ汎用文字列:バフ・デバフ対象能力 = 高揚
			アビ汎用変数:効果量 = 10
			CALL アビテンプレート_有利効果_付随バフ効果セット("九尾の神速")
		ENDIF

ENDSELECT



@固有戦闘開始時処理_キャラ_1025
#DIM イナホ隊列
#DIM 対象番号

イナホ隊列 = キャラ隊列検索(GETCHARA(1025))

IF イナホ隊列 == 0
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:適用範囲 = 味方全体
	アビ汎用文字列:バフ・デバフ枠 = 九尾天雷妖獣姫
	アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
	アビ汎用変数:効果量 = BATTLE_STATE:イナホ隊列:攻撃力 / 5
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_有利効果_パッシブバフ効果セット
ENDIF



@固有通常攻撃後処理_キャラ_1025(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM バフ・デバフ行数
#DIM イナホ隊列

SIF 全滅フラグ
	RETURN 0

イナホ隊列 = キャラ隊列検索(GETCHARA(1025))

IF 連撃数 == 3
	WSTR:(K++) = 「受けよ！」
	WSTR:(K++) = イナホのパワーフリップ！

	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果割合 = 100
	FOR LOCAL, 0, 戦闘中カウント:イナホ隊列:0 + 1
		CALL アビテンプレート_ダメージ処理_光属性
	NEXT
	アビ汎用変数:効果割合 = 300 + (戦闘中カウント:イナホ隊列:0 * 100)
	CALL アビテンプレート_ダメージ処理_光属性

	IF バフ番号取得_枠("フィーバー", イナホ隊列) < 0
		戦闘中カウント:イナホ隊列:1 += 戦闘中カウント:イナホ隊列:0 * 5
		SIF 戦闘中カウント:イナホ隊列:1 > 100
			戦闘中カウント:イナホ隊列:1 = 100
	ENDIF

	SIF 戦闘中カウント:イナホ隊列:0 < 2
		戦闘中カウント:イナホ隊列:0 += 1
ELSEIF 連撃数 < 3
	戦闘中カウント:イナホ隊列:0 = 0
ENDIF

IF バフ番号取得_枠("フィーバー", イナホ隊列) < 0
	戦闘中カウント:イナホ隊列:1 += 連撃数 * 5
	SIF 戦闘中カウント:イナホ隊列:1 > 100
		戦闘中カウント:イナホ隊列:1 = 100
ENDIF


@固有ターン開始時処理_キャラ_1025
#DIM イナホ隊列

イナホ隊列 = キャラ隊列検索(GETCHARA(1025))

IF 戦闘中カウント:イナホ隊列:1 == 100
	アビテンプレート用_アビ名 = フィーバーモード
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ枠 = フィーバー
	アビ汎用文字列:バフ・デバフ対象能力 = フィーバー
	アビ汎用変数:持続ターン = 3
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = フィーバー_絶対TA
	アビ汎用文字列:バフ・デバフ対象能力 = TA率
	アビ汎用変数:効果量 = 999
	アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
	CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")

	戦闘中カウント:イナホ隊列:1 = 0
ENDIF

IF バフ番号取得_枠("フィーバー", イナホ隊列) > -1
	アビテンプレート用_アビ名 = フィーバーモード
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	SELECTCASE RAND:6
		CASE 0
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 50
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
		CASE 1
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 防御力_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:効果割合 = 50
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
		CASE 2
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 連続攻撃率_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 連続攻撃率
			アビ汎用変数:効果割合 = 50
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
		CASE 3
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 追撃_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 追撃
			アビ汎用変数:効果割合 = 25
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
		CASE 4
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 再生_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 再生
			アビ汎用変数:効果量 = 100
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
		CASE 5
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 高揚_フィーバー
			アビ汎用文字列:バフ・デバフ対象能力 = 高揚
			アビ汎用変数:効果量 = 10
			アビ汎用変数:持続ターン = 3
			アビ汎用文字列:付随先_隊列設定 = {イナホ隊列}
			CALL アビテンプレート_有利効果_付随バフ効果セット("フィーバー")
	ENDSELECT
ENDIF



@固有戦闘不能時処理_キャラ_1025
#DIM 対象番号
#DIM 九尾天雷妖獣姫
#DIM 攻撃力

FOR 対象番号, 0, 4
	九尾天雷妖獣姫 = バフ番号取得_枠("九尾天雷妖獣姫", 対象番号)

	CALL 戦闘効果削除(九尾天雷妖獣姫)
NEXT




@固有奥義後処理_バフ_九尾天雷妖獣姫(バフ・デバフ行数, 全滅フラグ)
#DIM バフ・デバフ行数
#DIM 全滅フラグ
#DIM イナホ隊列

SIF 全滅フラグ
	RETURN 0

イナホ隊列 = キャラ隊列検索(GETCHARA(1025))

IF INRANGE(イナホ隊列, 0, 3) && バフ番号取得_枠("フィーバー", イナホ隊列) < 0
	戦闘中カウント:イナホ隊列:1 += 10
	SIF 戦闘中カウント:イナホ隊列:1 > 100
		戦闘中カウント:イナホ隊列:1 = 100
ENDIF



@探索欄表示_キャラ_1025(レイヤー番号, 隊列番号)
#DIM 隊列番号
#DIM レイヤー番号

GDRAWTEXT レイヤー番号, "FEVER:", 120, 90
GSETBRUSH レイヤー番号, 0xFF808080
GFILLRECTANGLE レイヤー番号, 231, 98, MAX(143 + 4, 1), 1 * 2 + 4 + 2
GSETBRUSH レイヤー番号, 0xFFB4B4B4
GFILLRECTANGLE レイヤー番号, 233, 1 + 98, MAX(139 + 4, 1), 4 + 2
IF 戦闘中カウント:隊列番号:1 > 0
	GSETBRUSH レイヤー番号, 0xFFFF8200
	GFILLRECTANGLE レイヤー番号, 233, 1 + 98 + 1, MAX(143 * 戦闘中カウント:隊列番号:1 / 100, 1), 4
ENDIF



@バフ・デバフ特殊表示_感電(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 感電
PRINTFORML Lvに応じて連続攻撃率が減少する状態［回復不可］
PRINTFORML Lv：　　　　　持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



@バフ・デバフ特殊表示_九尾の神速(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 九尾の神速
IF 基礎BATTLE_STATE:隊列番号:Lv >= 80
	PRINTFORML DA率・TA率が上昇/毎ターン奥義ゲージが上昇/与えるダメージが上昇している状態［消去不可］
ELSE
	PRINTFORML DA率・TA率が上昇/毎ターン奥義ゲージが上昇する状態［消去不可］
ENDIF
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



@バフ・デバフ特殊表示_九尾天雷妖獣姫(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 九尾天雷妖獣姫
PRINTFORML 攻撃力が上昇/奥義発動時、イナホのフィーバーゲージが上昇する状態［消去不可］
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_フィーバー(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML フィーバー
PRINTFORML 必ずトリプルアタック/味方全体にランダムな強化効果を付与する状態［消去不可］
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}

;--------------------------------------------------
;戦闘能力画面に表示されるキャラごとの固有処理説明
;--------------------------------------------------
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;　口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;　基本的にWAIT系列は使わないことを推奨
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_1025(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化
KSTR:(K++) = □ 特性：『九尾天雷妖獣姫』 □----------------------------------------------------------
KSTR:(K++) = 　奥義発動時、味方全体の攻撃力が累積上昇/奥義ゲージが溜まりにくい
KSTR:(K++) = 　◆1番目に編成時、味方全体の攻撃力が上昇/味方が奥義を発動する度、フィーバーゲージが上昇
KSTR:(K++) = 　
KSTR:(K++) = □ 特性：『クロスブルーフリッパー：特殊』 □-------------------------------------------
KSTR:(K++) = 　通常攻撃・奥義発動時、フィーバーゲージが上昇/フィーバーゲージが100％の時、ゲージを全て消費して自身にフィーバー効果
KSTR:(K++) = 　トリプルアタック時、パワーフリップ：特殊が発動
KSTR:(K++) = 　◆連続でトリプルアタック時、パワーフリップの性能アップ

CALL 口上変数表示(対象キャラ, 1)


