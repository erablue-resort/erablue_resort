
@固有奥義_1745(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名
#DIM バフ・デバフ行数
#DIM 連撃数
#DIM リーダー特性
#DIM マナボ１
#DIM マナボ２


IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	奥義名 = リバティ・ロアー+
	奥義威力 = 350
ELSE
	奥義名 = リバティ・ロアー
	奥義威力 = 200
ENDIF

;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>
			詳細文文字列受け渡し変数 += @"<br>自身に連撃効果［4ターン］"
		ELSE
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>
			詳細文文字列受け渡し変数 += @"<br>自身に連撃効果［2ターン］"
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		
		アビテンプレート用_アビ名表示済フラグ = 0

		アビ汎用文字列:実行時メッセージ１ = 「てやあっ！」
		アビ汎用文字列:実行時メッセージ２ = テオのパワーフリップ！
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_指定(奥義対象指定先)
		IF バフ存在判定_枠("キミを見つけたよ",戦闘行動キャラ)
			アビ汎用変数:効果割合 = 250 + (戦闘中カウント:戦闘行動キャラ:0 * 150)
		ELSE
			アビ汎用変数:効果割合 = 150 + (戦闘中カウント:戦闘行動キャラ:0 * 150)
		ENDIF
		;LS適用されているかどうか。テオリーダーなら100%強化の250%、そうでなければ150%が基礎威力になる。
		SIF 戦闘行動キャラ == 0
			リーダー特性 = MIN(60, 戦闘中カウント:戦闘行動キャラ:与ヒット数合計 / 15 * 3)
			;リーダー特性適用で１５ヒット毎に３％加算
		SIF BATTLE_STATE:戦闘行動キャラ:Lv >= 30
			マナボ１ = MIN(40, 戦闘中カウント:戦闘行動キャラ:与ヒット数合計 / 15 * 2)
			;マナボ１解放で１５ヒット毎に３％加算
		IF BATTLE_STATE:戦闘行動キャラ:Lv >= 80
			マナボ２ = MIN(60, 戦闘中カウント:戦闘行動キャラ:与ヒット数合計 / 15 * 3)
			;パワフリの匠
		ELSEIF BATTLE_STATE:戦闘行動キャラ:Lv >= 70
			マナボ２ = MIN(40, 戦闘中カウント:戦闘行動キャラ:与ヒット数合計 / 15 * 2)
			;パワフリの鉄人
		ELSEIF BATTLE_STATE:戦闘行動キャラ:Lv >= 60
			マナボ２ = MIN(20, 戦闘中カウント:戦闘行動キャラ:与ヒット数合計 / 15 * 1)
			;パワフリの達人
		ELSE
			;Lv６０いってなければマナボ２の補正は無し。
		ENDIF
		;ここまでパッシブによるパワフリ補正処理。一番しんどい！！きくうしさん本当にありがとうございます。
		アビ汎用変数:効果割合 = アビ汎用変数:効果割合 * (リーダー特性 + マナボ１ + マナボ２ + 100) / 100
		;ここでダメージ計算おわり。長い！！
		戦闘中カウント:戦闘行動キャラ:0 += 1
		CALL アビテンプレート_ダメージ処理_光属性

		戦闘中カウント:戦闘行動キャラ:与ヒット数合計 += 13
		;リバティロアーは１４hitする。

		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 連撃
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:効果量 = 1
		アビ汎用変数:持続ターン = 2
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT
