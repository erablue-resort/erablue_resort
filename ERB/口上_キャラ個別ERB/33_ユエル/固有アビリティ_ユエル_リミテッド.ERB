@スタイル変更_33(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
;この関数はいくつ別スタイル作ってもキャラ毎に一個

SELECTCASE 動作モード
	CASE "スタイル名取得"
		VARSET RESULTS
		;RESULTS:Xに肩書を、RESULTS:X+10にリミテッドや水着など通称(？)を入れる
		RESULTS:0 = %NAME:対象キャラ%
		RESULTS:10 = ノーマル

		RESULTS:1 = [千年を超える者]ユエル
		RESULTS:11 = リミテッド
	CASE @"スタイル解説_%NAME:対象キャラ%"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += @"■%NAME:対象キャラ%<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "通常のスタイル。ステータス変動なし。火属性。<br>"
		TSTR:スタイル解説 += "<br>"
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, NAME:対象キャラ)
	CASE "スタイル解説_[千年を超える者]ユエル"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += "■[千年を超える者]ユエル<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "リミテッドVerをモチーフとしたスタイル。火属性。<br>"
		TSTR:スタイル解説 += "<br>"
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, "[千年を超える者]ユエル")
	CASE "変更後処理"
		;CSTR:対象キャラ:スタイル管理文字列をキーにして処理を実行
		;一人称や二人称、素質の変化などを想定、今回は何もなし
		SELECTCASE CSTR:対象キャラ:スタイル管理文字列
			CASE ""
			CASE "[千年を超える者]ユエル"
			;CASE RESULTS:2
			;CASE RESULTS:3
		ENDSELECT
ENDSELECT



@スタイルステータス補正_千年を超える者_ユエル(対象キャラ)
#DIM 対象キャラ
;関数名に[]が使えないため、しょうがなく[]排除時の文字列をキーに

装備ステータス補正保存:対象キャラ:基礎属性変更 = 属性文字列数値変換("火") + 10



@固有アビ_33_10(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

IF スタイル判定関数(キャラ番号, "[千年を超える者]ユエル") == 0
	アビ名 = 
	RETURN 0
ENDIF

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 45
	アビ名 = 蒼焔狐+
	消費ＭＰ = 125
ELSE
	アビ名 = 蒼焔狐
	消費ＭＰ = 150
ENDIF
SIF アビ名 == ""
	RETURN

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の火属性ダメージを2回与える。
		詳細文文字列受け渡し変数 += @"<br>［1］のバフ消去を与える。"
		詳細文文字列受け渡し変数 += @"<br>（4ターン・消去不可）の狐火効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>［累積50（Lv1）/最大500（Lv10）］（5ターン・消去不可）の火傷効果を与える。"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の火属性ダメージを2回与える。
		詳細文文字列受け渡し変数 += @"<br>［1］のバフ消去を与える。"
		詳細文文字列受け渡し変数 += @"<br>（4ターン・消去不可）の狐火効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［30％］の命中率減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［250］の自傷効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>［累積50（Lv1）/最大500（Lv10）］（5ターン・消去不可）の火傷効果を与える。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 200
		CALL アビテンプレート_ダメージ処理_火属性
		CALL アビテンプレート_ダメージ処理_火属性

		CALL アビ汎用変数文字列リセット
		CALL アビテンプレート_不利効果_バフ消去
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 狐火
		アビ汎用文字列:バフ・デバフ対象能力 = 狐火
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 狐火_命中率
		アビ汎用文字列:バフ・デバフ対象能力 = 命中率
		アビ汎用変数:効果量 = 30
		CALL アビテンプレート_有利効果_付随バフ効果セット("狐火")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 狐火_自傷
		アビ汎用文字列:バフ・デバフ対象能力 = 自傷
		アビ汎用変数:効果量 = 250
		CALL アビテンプレート_有利効果_付随バフ効果セット("狐火")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 火傷
		アビ汎用文字列:バフ・デバフ対象能力 = 自傷
		アビ汎用変数:効果量 = 1
		アビ汎用変数:累積上限_固定値 = 10
		アビ汎用変数:持続ターン = 5
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 火傷_自傷
		アビ汎用文字列:バフ・デバフ対象能力 = 自傷
		アビ汎用変数:付随量 = 50
		CALL アビテンプレート_不利効果_付随デバフ効果セット("火傷")
ENDSELECT



@固有アビ_33_11(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 鎮番号
#DIM 躍番号

鎮番号 = バフ番号取得_枠("紅之舞・鎮", 戦闘行動キャラ)
躍番号 = バフ番号取得_枠("紅之舞・躍", 戦闘行動キャラ)

IF スタイル判定関数(キャラ番号, "[千年を超える者]ユエル") == 0
	アビ名 = 
	RETURN 0
ENDIF

IF 戦闘中カウント:キャラ隊列検索(GETCHARA(33)):2 == 1 && 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 紅之舞・暁＋
	消費ＭＰ = 0
ELSEIF 戦闘中カウント:キャラ隊列検索(GETCHARA(33)):2 == 1
	アビ名 = 紅之舞・暁
	消費ＭＰ = 0
ELSEIF 戦闘中カウント:キャラ隊列検索(GETCHARA(33)):1 == 1 && 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 紅之舞・躍＋
	消費ＭＰ = 0
ELSEIF 戦闘中カウント:キャラ隊列検索(GETCHARA(33)):1 == 1
	アビ名 = 紅之舞・躍
	消費ＭＰ = 0
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 紅之舞・鎮＋
	消費ＭＰ = 50
ELSE
	アビ名 = 紅之舞・鎮
	消費ＭＰ = 100
ENDIF
SIF アビ名 == ""
	RETURN

IF キャラ隊列検索(キャラ番号) >= 0
	SIF 戦闘中カウント:キャラ隊列検索(GETCHARA(33)):0 == 1
		アビテンプレート用_アビ封印用フラグ = 1
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF アビ名 == "紅之舞・鎮" || アビ名 == "紅之舞・鎮＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・鎮効果を与える。
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
			詳細文文字列受け渡し変数 += @"<br>◆使用後、チェインバースト・自身のトリプルアタックが合計6回発動すると『紅之舞・躍』に変化する。"
		ELSEIF アビ名 == "紅之舞・躍" || アビ名 == "紅之舞・躍＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・躍効果を与える。
			詳細文文字列受け渡し変数 += @"<br>［1000％］（独自枠・1回）の回避率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>（1回）の再行動効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。/このアビリティでは行動回数を消費しない。"
			詳細文文字列受け渡し変数 += @"<br>◆使用後、チェインバースト・自身のトリプルアタックが合計6回発動すると『紅之舞・暁』に変化する。"
		ELSEIF アビ名 == "紅之舞・暁" || アビ名 == "紅之舞・暁＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・暁効果を与える。
			詳細文文字列受け渡し変数 += @"<br>［1000％］（独自枠・1回）の回避率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>（1回）の三回行動効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		IF アビ名 == "紅之舞・鎮" || アビ名 == "紅之舞・鎮＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・鎮効果を与える。
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［50］のＨＰ回復を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［1ターン］の弱体効果短縮を与える。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
			詳細文文字列受け渡し変数 += @"<br>◆使用後、チェインバースト・自身のトリプルアタックが合計6回発動すると『紅之舞・躍』に変化する。"
		ELSEIF アビ名 == "紅之舞・躍" || アビ名 == "紅之舞・躍＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・躍効果を与える。
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［50］のＨＰ回復を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［1ターン］の弱体効果短縮を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞通常攻撃後に蒼焔狐が発動する。"
			詳細文文字列受け渡し変数 += @"<br>［1000％］（独自枠・1回）の回避率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>（1回）の再行動効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
			詳細文文字列受け渡し変数 += @"<br>◆使用後、チェインバースト・自身のトリプルアタックが合計6回発動すると『紅之舞・暁』に変化する。"
		ELSEIF アビ名 == "紅之舞・暁" || アビ名 == "紅之舞・暁＋"
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（消去不可）の紅之舞・暁効果を与える。
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［50］のＨＰ回復を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞ターン終了時、味方全体に［1ターン］の弱体効果短縮を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞通常攻撃後に蒼焔狐が発動する。"
			詳細文文字列受け渡し変数 += @"<br>＞［20％］の追撃効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>＞［50％］のクリティカルダメージ率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［1000％］（独自枠・1回）の回避率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>（1回）の三回行動効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティは再使用出来ない。"
			詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
		ENDIF
	CASE "アビ効果"
		IF アビ名 == "紅之舞・鎮" || アビ名 == "紅之舞・鎮＋"
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 紅之舞・鎮
			アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞・鎮
			アビ汎用変数:持続ターン = -1
			アビ汎用変数:消去不可オプション = 1
			アビ汎用変数:特殊表示オプション = 1
			CALL アビテンプレート_有利効果_バフ効果セット
		ELSEIF アビ名 == "紅之舞・躍" || アビ名 == "紅之舞・躍＋"
			CALL 戦闘効果削除(鎮番号)
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 紅之舞・躍
			アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞・躍
			アビ汎用変数:持続ターン = -1
			アビ汎用変数:消去不可オプション = 1
			アビ汎用変数:特殊表示オプション = 1
			CALL アビテンプレート_有利効果_バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 完全回避
			アビ汎用文字列:バフ・デバフ対象能力 = 回避率
			アビ汎用変数:効果量 = 1000
			アビ汎用変数:持続回数 = 1
			CALL アビテンプレート_有利効果_バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 再行動
			アビ汎用文字列:バフ・デバフ対象能力 = 再行動
			アビ汎用変数:効果量 = 1
			アビ汎用変数:持続回数 = 1
			CALL アビテンプレート_有利効果_バフ効果セット
		ELSEIF アビ名 ==  "紅之舞・暁" || アビ名 == "紅之舞・暁＋"
			CALL 戦闘効果削除(躍番号)
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 紅之舞・暁
			アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞・暁
			アビ汎用変数:持続ターン = -1
			アビ汎用変数:消去不可オプション = 1
			アビ汎用変数:特殊表示オプション = 1
			CALL アビテンプレート_有利効果_バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 紅之舞・暁_追撃
			アビ汎用文字列:バフ・デバフ対象能力 = 追撃
			アビ汎用変数:効果割合 = 20
			CALL アビテンプレート_有利効果_付随バフ効果セット("紅之舞・暁")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 紅之舞・暁_クリティカルダメージ率
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカルダメージ率
			アビ汎用変数:効果量 = 50
			CALL アビテンプレート_有利効果_付随バフ効果セット("紅之舞・暁")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 継がれし王の装束_クリティカル率
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカル率
			アビ汎用変数:効果量 = 100
			アビ汎用文字列:適用範囲 = 味方全体
			CALL アビテンプレート_有利効果_付随バフ効果セット("紅之舞・暁")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 継がれし王の装束_与ダメージ
			アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
			アビ汎用変数:効果割合 = 5
			アビ汎用文字列:適用範囲 = 味方全体
			CALL アビテンプレート_有利効果_付随バフ効果セット("紅之舞・暁")
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 完全回避
			アビ汎用文字列:バフ・デバフ対象能力 = 回避率
			アビ汎用変数:効果量 = 1000
			アビ汎用変数:持続回数 = 1
			CALL アビテンプレート_有利効果_バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 三回行動
			アビ汎用文字列:バフ・デバフ対象能力 = 再行動
			アビ汎用変数:効果量 = 2
			アビ汎用変数:持続回数 = 1
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
		
		戦闘中カウント:キャラ隊列検索(GETCHARA(33)):0 = 1
		戦闘中カウント:キャラ隊列検索(GETCHARA(33)):1 = 0
		戦闘中カウント:キャラ隊列検索(GETCHARA(33)):2 = 0
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT



@固有アビ_33_12(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ユエル隊列
#DIM 暁判定
#DIM クールタイム
#DIM 対象一時保存

ユエル隊列 = キャラ隊列検索(GETCHARA(33))

IF スタイル判定関数(キャラ番号, "[千年を超える者]ユエル") == 0
	アビ名 = 
	RETURN 0
ENDIF

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 25
	アビ名 = 参之舞・熾炎
	消費ＭＰ = 300
ELSE
	アビ名 = 
ENDIF
SIF アビ名 == ""
	RETURN

暁判定 = バフ番号取得_枠("紅之舞・暁", 戦闘行動キャラ)

IF INRANGE(ユエル隊列, 0, 3) && 戦闘中カウント:ユエル隊列:3
	クールタイム = MAX(0, 7 + 戦闘中カウント:ユエル隊列:3 - 現在ターン数)
	SIF クールタイム > 0
		アビテンプレート用_アビ封印用フラグ = 1
ELSE
	クールタイム = 0
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に［60％］（D枠・1回）の追撃効果を与える。
		詳細文文字列受け渡し変数 += @"<br>即座に通常攻撃を行う。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティでは行動回数を消費しない。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティは［7ターン］のCTが発生する。残り{クールタイム}ターン。"
		詳細文文字列受け渡し変数 += @"<br>◆紅之舞･暁効果中、2回発動する。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		対象一時保存 = アビテンプレート用_対象保存:0
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 追撃D
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:効果割合 = 60
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_指定(対象一時保存)
		アビ汎用変数:効果割合 = 100
		CALL アビテンプレート_通常攻撃処理
		
		IF 暁判定 > -1
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 追撃D
			アビ汎用文字列:バフ・デバフ対象能力 = 追撃
			アビ汎用変数:効果割合 = 60
			アビ汎用変数:持続回数 = 1
			CALL アビテンプレート_有利効果_バフ効果セット

			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_指定(対象一時保存)
			アビ汎用変数:効果割合 = 100
			CALL アビテンプレート_通常攻撃処理
		ENDIF
		
		アビテンプレート用_行動消費無しフラグ = 1
		戦闘中カウント:戦闘行動キャラ:3 = 現在ターン数
ENDSELECT



@千年を超える者固有ターン開始時処理_キャラ
#DIM バフ・デバフ行数
#DIM ユエル隊列
#DIM 狐火判定

ユエル隊列 = キャラ隊列検索(GETCHARA(33))

SIF BATTLE_STATE:ユエル隊列:ＨＰ < 1
	RETURN 0

FOR LOCAL, 10, 20
	狐火判定 = デバフ番号取得_枠("狐火", LOCAL)
	BREAK
NEXT

IF  狐火判定 > -1
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ枠 = 参之王を継ぐ者
	アビ汎用文字列:バフ・デバフ対象能力 = 参之王を継ぐ者
	アビ汎用変数:持続ターン = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = -1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 参之王を継ぐ者_ダメージ補正_通常攻撃ダメージ
	アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_通常攻撃ダメージ
	アビ汎用変数:効果割合 = 10
	アビ汎用文字列:適用範囲 = 味方全体
	CALL アビテンプレート_有利効果_付随バフ効果セット("参之王を継ぐ者")
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 参之王を継ぐ者_DA率
	アビ汎用文字列:バフ・デバフ対象能力 = DA率
	アビ汎用変数:効果量 = 100
	アビ汎用文字列:適用範囲 = 味方全体
	CALL アビテンプレート_有利効果_付随バフ効果セット("参之王を継ぐ者")
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 参之王を継ぐ者_TA率
	アビ汎用文字列:バフ・デバフ対象能力 = TA率
	アビ汎用変数:効果量 = 30
	アビ汎用文字列:適用範囲 = 味方全体
	CALL アビテンプレート_有利効果_付随バフ効果セット("参之王を継ぐ者")
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 参之王を継ぐ者_回避率
	アビ汎用文字列:バフ・デバフ対象能力 = 回避率
	アビ汎用変数:効果量 = 30
	アビ汎用文字列:適用範囲 = 味方全体
	CALL アビテンプレート_有利効果_付随バフ効果セット("参之王を継ぐ者")
ENDIF

;表示を出さないようにリセット
CALL アビテンプレ変数リセット



@千年を超える者固有通常攻撃後処理_キャラ(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM 躍暁判定
#DIM 鎮躍判定

SIF 全滅フラグ
	RETURN 0

躍暁判定 = MAX(バフ番号取得_枠("紅之舞・躍", 戦闘行動キャラ), バフ番号取得_枠("紅之舞・暁", 戦闘行動キャラ))
鎮躍判定 = MAX(バフ番号取得_枠("紅之舞・鎮", 戦闘行動キャラ), バフ番号取得_枠("紅之舞・躍", 戦闘行動キャラ))

IF 躍暁判定 > -1
	CALL アビ汎用変数文字列リセット
	CALL アビテンプレート用_表示メッセージ変換処理
	アビテンプレート用_アビ名表示済フラグ = 0

	アビ汎用文字列:実行時メッセージ１ = 「焼き尽くしたる！」
	アビ汎用文字列:実行時メッセージ２ = ユエルの蒼焔狐！

	アビ汎用変数:効果割合 = 200
	CALL アビテンプレート_ダメージ処理_火属性
	CALL アビテンプレート_ダメージ処理_火属性

	CALL アビ汎用変数文字列リセット
	CALL アビテンプレート_不利効果_バフ消去
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 狐火
	アビ汎用文字列:バフ・デバフ対象能力 = 狐火
	アビ汎用変数:持続ターン = 4
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_不利効果_デバフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 狐火_命中率
	アビ汎用文字列:バフ・デバフ対象能力 = 命中率
	アビ汎用変数:効果量 = 30
	CALL アビテンプレート_有利効果_付随バフ効果セット("狐火")
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 狐火_火傷
	アビ汎用文字列:バフ・デバフ対象能力 = 火傷
	アビ汎用変数:効果量 = 250
	CALL アビテンプレート_有利効果_付随バフ効果セット("狐火")
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 火傷
	アビ汎用文字列:バフ・デバフ対象能力 = 自傷
	アビ汎用変数:効果量 = 1
	アビ汎用変数:累積上限_固定値 = 10
	アビ汎用変数:持続ターン = 5
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_不利効果_累積デバフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 火傷_自傷
	アビ汎用文字列:バフ・デバフ対象能力 = 自傷
	アビ汎用変数:付随量 = 50
	CALL アビテンプレート_不利効果_付随デバフ効果セット("火傷")
ENDIF

IF 連撃数 == 3 && 鎮躍判定 > -1
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞
	アビ汎用変数:累積上限_固定値 = 6
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印追加(1)
ENDIF



@千年を超える者固有ターン終了時処理_キャラ
#DIM 対象番号
#DIM ユエル隊列
#DIM 鎮判定
#DIM 躍判定
#DIM 暁判定
#DIM デバフ番号
#DIM 短縮後効果ターン

ユエル隊列 = キャラ隊列検索(GETCHARA(33))

鎮判定 = バフ番号取得_枠("紅之舞・鎮", ユエル隊列)
躍判定 = バフ番号取得_枠("紅之舞・躍", ユエル隊列)
暁判定 = バフ番号取得_枠("紅之舞・暁", ユエル隊列)

IF ターン中奥義回数保存 > 1 && 鎮判定 > -1 && 躍判定 > -1
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞
	アビ汎用変数:累積上限_固定値 = 6
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印追加(1)
ENDIF

IF 刻印現在数確認("紅之舞", ユエル隊列) == 6
	IF 鎮判定 > -1
		戦闘中カウント:ユエル隊列:0 = 0
		戦闘中カウント:ユエル隊列:1 = 1
		
		WSTR:(K++) = ユエルの紅之舞・鎮が紅之舞・躍に転じた！
		
		CALL メッセージ欄表示用関数(,,,0)
		CALL 口上変数初期化
	ELSEIF 躍判定 > -1
		戦闘中カウント:ユエル隊列:0 = 0
		戦闘中カウント:ユエル隊列:2 = 1
		
		WSTR:(K++) = ユエルの紅之舞・鎮が紅之舞・躍に転じた！
		
		CALL メッセージ欄表示用関数(,,,0)
		CALL 口上変数初期化
	ENDIF
	
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 紅之舞
	アビ汎用変数:累積上限_固定値 = 6
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印減少(999)
ENDIF

IF 鎮判定 > -1 || 躍判定 > -1 || 暁判定 > -1
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = ALL
	アビ汎用変数:効果量 = 1
	CALL アビテンプレート_有利効果_デバフ効果短縮_持続ターン
	
	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果量 = 50
	CALL アビテンプレート_回復処理_MAXでも回復
ENDIF



@千年を超える者探索欄表示_キャラ(レイヤー番号, 隊列番号)
#DIM 隊列番号
#DIM レイヤー番号
#DIM 鎮判定
#DIM 躍判定
#DIM 暁判定

鎮判定 = バフ番号取得_枠("紅之舞・鎮", 隊列番号)
躍判定 = バフ番号取得_枠("紅之舞・躍", 隊列番号)
暁判定 = バフ番号取得_枠("紅之舞・暁", 隊列番号)

IF 鎮判定 > -1
	GSETBRUSH レイヤー番号, 0xFFEF8800
	GDRAWTEXT レイヤー番号, @"❀", 120, 90
ENDIF

IF 躍判定 > -1
	GSETBRUSH レイヤー番号, 0xFFD97DC1
	GDRAWTEXT レイヤー番号, @"❀", 120, 90
ENDIF

IF 暁判定 > -1
	GSETBRUSH レイヤー番号, 0xFFB83110
	GDRAWTEXT レイヤー番号, @"❀", 120, 90
ENDIF



@バフ・デバフ特殊表示_狐火(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 狐火
PRINTFORML 命中率が減少し、毎ターンダメージを受ける状態
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



@バフ・デバフ特殊表示_紅之舞・鎮(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 紅之舞・鎮
PRINTFORML ターン終了時、味方全体のHPを回復し、弱体効果ターンを短縮する状態（消去不可）
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_紅之舞・躍(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 紅之舞・躍
PRINTFORML ターン終了時、味方全体のHPを回復し、弱体効果ターンを短縮/通常攻撃後に蒼焔狐が発動する状態（消去不可）
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_紅之舞・暁(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 紅之舞・暁
PRINTFORML ターン終了時、味方全体のHPを回復し、弱体効果ターンを短縮/通常攻撃後に蒼焔狐が発動/通常攻撃時に追撃を行い、クリティカル発生時に与ダメージが上昇する状態（消去不可）
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_紅之舞(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 紅之舞
PRINTFORML チェインバースト・自身のトリプルアタック発生時にLvが上昇し、Lvが6に到達時に2番目のアビリティが変化する状態（最大Lv6・消去不可）
PRINTFORML Lv：{刻印現在数確認("紅之舞", 隊列番号)}　　　　　持続ターン：永続



;--------------------------------------------------
;戦闘能力画面に表示されるキャラごとの固有処理説明
;--------------------------------------------------
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;　口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;　基本的にWAIT系列は使わないことを推奨
;--------------------------------------------------
@千年を超える者口上_ステータス画面_固有特性解説(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

KSTR:(K++) = □ 特性：『参之王を継ぐ者』 □---------------------------------------------------------------
KSTR:(K++) = 　狐火状態の敵がいる時、味方全体の通常攻撃与ダメージ・DA率・TA率・回避率上昇
KSTR:(K++) = 　
KSTR:(K++) = □ 特性：『継がれし王の装束』 □-----------------------------------------------------------------
KSTR:(K++) = 　紅之舞・暁効果中、味方全体のクリティカル率・与ダメージ上昇

CALL 口上変数表示(対象キャラ, 1)



@千年を超える者固有奥義(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名
#DIM 暁判定

;IF 基礎BATTLE_STATE:キャラ番号:Lv >= 
;	奥義名 =
;	奥義威力 = 
;ELSE
	奥義名 = 紅之舞・焼浄
	奥義威力 = 450
;ENDIF

暁判定 = バフ番号取得_枠("紅之舞・暁", キャラ隊列検索(GETCHARA(33)))

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％
		詳細文文字列受け渡し変数 += @"<br>［累積10％/最大40％］（累積枠・5ターン）の火属性耐性減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>自身に［累積100/最大500］（累積枠）の与ダメージ上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>◆紅之舞・暁効果中、2回発動する。"
		RETURN 奥義威力
	CASE "奥義前効果"
		IF 暁判定 > -1
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
			アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
			アビ汎用変数:持続回数 = 1
			アビ汎用変数:消去不可オプション = 1
			アビ汎用変数:特殊表示オプション = -1
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
	CASE "奥義追加効果"
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_火累積
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_火
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 40
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		CALL アビ対象選択テンプレート_自己のみ
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 与ダメージ累積
		アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
		アビ汎用変数:効果量 = 100
		アビ汎用変数:累積上限_固定値 = 500
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
ENDSELECT
