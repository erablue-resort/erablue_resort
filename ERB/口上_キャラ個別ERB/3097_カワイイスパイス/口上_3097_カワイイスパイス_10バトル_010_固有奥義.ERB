;--------------------------------------------------
;●ライセンス/更新履歴/概要/使用フラグ
;--------------------------------------------------
;　いずれもカワイイスパイス口上_readme.txt記載に従う
;--------------------------------------------------
@固有奥義_3097(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIM 恋慕フラグ = 0
#DIM ディスペルフラグ = 0
#DIMS 恋慕説明 ;説明側で判定したくないので空文字にしておく。
#DIM セフレフラグ = 0
#DIM 追加状態異常フラグ = 0
#DIMS セフレ説明 ;説明側で判定したくないので空文字にしておく。
#DIM 弱体耐性デバフ効果割合
#DIM ステータスデバフ効果割合
#DIM ターンダメージ効果量
#DIM 攻撃対象一時保存
#DIMS 基礎奥義名
#DIMS 奥義名 ;最終的な奥義名の出力が入る
#DIMS 陥落奥義追加文字列

基礎奥義名 = ケオスディーラー

IF TALENT:キャラ番号:恋慕
	;恋慕でも結婚でも同じ、当面は。
	恋慕フラグ = 1
ELSEIF TALENT:キャラ番号:セフレ
	セフレフラグ = 1
ENDIF

;陥落状況を変更するのは手間なので、奥義の外に影響でない範囲でデバッグ用処理追加
;[IF_DEBUG]
;	恋慕フラグ = 0
;	セフレフラグ = 1
;[ENDIF]


IF 恋慕フラグ
	陥落奥義追加文字列 = EX
	ディスペルフラグ = 1
	恋慕説明 = 【陥落特典】恋慕陥落により、敵強化解除を行うように。<br>
ELSEIF セフレフラグ
	陥落奥義追加文字列 = ALT
	追加状態異常フラグ = 1
	セフレ説明 = 【陥落特典】セフレ陥落により、追加で状態異常を付与するように。<br>
ENDIF

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	奥義名 = %基礎奥義名%%陥落奥義追加文字列%＋＋
	奥義威力 = 550
    弱体耐性デバフ効果割合 = 10
	ステータスデバフ効果割合 = 15
    ターンダメージ効果量 = 1000
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 25
	奥義名 = %基礎奥義名%%陥落奥義追加文字列%＋
	奥義威力 = 500
    弱体耐性デバフ効果割合 = 5
	ステータスデバフ効果割合 = 10
    ターンダメージ効果量 = 300
ELSE
	奥義名 = %基礎奥義名%%陥落奥義追加文字列%
	奥義威力 = 450
    弱体耐性デバフ効果割合 = 5
	ステータスデバフ効果割合 = 5
    ターンダメージ効果量 = 100
ENDIF

	アビ汎用文字列:実行時メッセージ１ = 「瘴気の魔女、死せる魔王。一滴残らず搾り取る――！」
	アビ汎用文字列:実行時メッセージ２ = 「ケオスディーラー！！」

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		詳細文文字列受け渡し変数 = <br>敵単体に様々な状態異常を付与し、自属性による奥義威力：{奥義威力}％のダメージを与える。<br>%恋慕説明%%セフレ説明%
		RETURN 奥義威力
	CASE "奥義前効果"
		;もりもりデバフを盛る。
        ;ピュリファイアとのシナジー目的

		攻撃対象一時保存 = アビテンプレート用_対象保存:0

        ;弱体耐性デバフ
        ;これがあるので下記成功確率は実質的にもう少し高い
		CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用変数:効果割合 = 弱体耐性デバフ効果割合
		アビ汎用文字列:バフ・デバフ枠 = 弱体耐性A
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
		アビ汎用変数:基礎成功確率 = 200
		アビ汎用変数:持続ターン = 1
		CALL アビテンプレート_不利効果_デバフ効果セット

        ;ステータスデバフ
        CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
        アビ汎用変数:効果割合 = ステータスデバフ効果割合
		アビ汎用文字列:バフ・デバフ枠 = 防御力A
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:持続ターン = 3
        アビ汎用変数:基礎成功確率 = 90
		CALL アビテンプレート_不利効果_デバフ効果セット
        
        CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
        アビ汎用変数:効果割合 = ステータスデバフ効果割合
        アビ汎用文字列:バフ・デバフ枠 = 攻撃力A
        アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
        アビ汎用変数:持続ターン = 3
        アビ汎用変数:基礎成功確率 = 90
        CALL アビテンプレート_不利効果_デバフ効果セット

		CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用文字列:バフ・デバフ枠 = DA率A
		アビ汎用文字列:バフ・デバフ対象能力 = DA率
		アビ汎用変数:効果量 = ステータスデバフ効果割合
		アビ汎用変数:持続ターン = 3
        アビ汎用変数:基礎成功確率 = 90
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用文字列:バフ・デバフ枠 = TA率A
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:効果量 = ステータスデバフ効果割合
		アビ汎用変数:持続ターン = 3
        アビ汎用変数:基礎成功確率 = 90
		CALL アビテンプレート_不利効果_デバフ効果セット
    
        ;DoT付与
        CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用変数:効果量 = ターンダメージ効果量
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 80
        アビ汎用文字列:バフ・デバフ枠 = 火傷
		アビ汎用文字列:バフ・デバフ対象能力 = 火傷
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 毒
		アビ汎用文字列:バフ・デバフ対象能力 = 毒
		CALL アビテンプレート_不利効果_デバフ効果セット

        ;属性防御デバフ
        CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用変数:効果量 = ステータスデバフ効果割合
		アビ汎用変数:持続ターン = 3
        アビ汎用変数:基礎成功確率 = 60
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_火
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_火
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_水
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_水
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_風
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_風
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_土
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_土
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_光
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_光
		CALL アビテンプレート_不利効果_デバフ効果セット
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_闇
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_闇
		CALL アビテンプレート_不利効果_デバフ効果セット

        ;入ったらラッキー枠
        CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用文字列:バフ・デバフ枠 = 暗闇
		アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
		アビ汎用変数:効果割合 = 30
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 30
		CALL アビテンプレート_不利効果_デバフ効果セット
		CALL アビ汎用変数文字列リセット
        CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
		アビ汎用文字列:バフ・デバフ枠 = 恐怖
		アビ汎用文字列:バフ・デバフ対象能力 = 恐怖
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 30
		CALL アビテンプレート_不利効果_デバフ効果セット

		;セフレ陥落処理
		IF 追加状態異常フラグ
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
			アビ汎用文字列:バフ・デバフ枠 = 命中率A
			アビ汎用文字列:バフ・デバフ対象能力 = 命中率
			アビ汎用変数:効果割合 = ステータスデバフ効果割合
			アビ汎用変数:持続ターン = 3
			アビ汎用変数:基礎成功確率 = 80
			CALL アビテンプレート_不利効果_デバフ効果セット
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
			アビ汎用文字列:バフ・デバフ枠 = 回避率A
			アビ汎用文字列:バフ・デバフ対象能力 = 回避率
			アビ汎用変数:効果割合 = ステータスデバフ効果割合
			アビ汎用変数:持続ターン = 3
			アビ汎用変数:基礎成功確率 = 80
			CALL アビテンプレート_不利効果_デバフ効果セット
			CALL アビ汎用変数文字列リセット
        	CALL アビ対象選択テンプレート_指定(攻撃対象一時保存)
			アビ汎用文字列:バフ・デバフ枠 = 魅了
			アビ汎用文字列:バフ・デバフ対象能力 = 魅了
			アビ汎用変数:効果割合 = 30
			アビ汎用変数:持続ターン = 3
			アビ汎用変数:基礎成功確率 = 60
			CALL アビテンプレート_不利効果_デバフ効果セット

		ENDIF

		;恋慕陥落処理
		IF ディスペルフラグ
			CALL アビテンプレート_不利効果_バフ消去()
		ENDIF

ENDSELECT
