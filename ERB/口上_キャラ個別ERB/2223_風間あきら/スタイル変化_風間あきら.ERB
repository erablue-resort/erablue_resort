;****************************************
;縁結び系の処理に使う特殊関数
;****************************************
;・使い方
;「2223」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;「<スタイル名>」を任意のスタイル名に変更する
;****************************************

;--------------------------------------------------
;スタイル変更基礎関数
;--------------------------------------------------
@スタイル変更_2223(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
;この関数はいくつ別スタイル作ってもキャラ毎に一個
;必須関数、スタイル変更を追加する場合、必ず作成すること

SELECTCASE 動作モード
	CASE "スタイル名取得"
        ;ここは触らない
		VARSET RESULTS
		RESULTS:0 = %NAME:対象キャラ%
		RESULTS:10 = ノーマル

		;RESULTS:Xに名前全体を、RESULTS:X+10にリミテッドや水着など通称(？)を入れる
        ;例：
		; RESULTS:1 = [強化状態二つ名]テスト太郎
		; RESULTS:11 = 強化スタイル
		IF 陥落チェック(対象キャラ)
			RESULTS:1 = [甦る外道魂]パワードアキラ
			RESULTS:11 = 防御特化
		ENDIF
        
		; 複数スタイルを作りたい場合はRESULTS:2、RESULTS:12のように数字をふやしていく
        
	CASE @"スタイル解説_%NAME:対象キャラ%"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += @"■%NAME:対象キャラ%<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "通常の姿。ステータス・属性変動なし。<br>"
		TSTR:スタイル解説 += "<br>"
        ;このCALLはそのままで良い
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, NAME:対象キャラ)
	CASE "スタイル解説_[甦る外道魂]パワードアキラ"
		TSTR:スタイル解説 = 
		TSTR:スタイル解説 += "■[甦る外道魂]パワードアキラ<br>"
		TSTR:スタイル解説 += "<br>"
		TSTR:スタイル解説 += "あきらがライダースーツ一式を見に包んだ姿。<br>"
		TSTR:スタイル解説 += "以前外道高校に潜入した時はこの姿で『総番長の弟』と名乗ったようだ<br>"
		TSTR:スタイル解説 += "男装した時の癖なのか、ヘルメットを被ると男性的な口調に変わる。<br>"
		TSTR:スタイル解説 += "<br>"
        ;このCALLはそのままで良い、戦闘アビが変動しない場合は消しても良い
		CALL スタイル奥義アビ表示_汎用文章(対象キャラ, "[甦る外道魂]パワードアキラ")
	CASE "変更後処理"
		;CSTR:対象キャラ:スタイル管理文字列をキーにして処理を実行
		;一人称や二人称、素質の変化などの調教側ステータスの変更を想定
        ;戦闘ステータスは別の関数
		SELECTCASE CSTR:対象キャラ:スタイル管理文字列
			CASE "[功夫ライダー]風間あきら"
                ;通常時に戻す処理
			CASE "[甦る外道魂]パワードアキラ"
                ;スタイル変更時の処理
		ENDSELECT
ENDSELECT


;--------------------------------------------------
;スタイル変更時、戦闘ステータス変動
;--------------------------------------------------
@スタイルステータス補正_甦る外道魂_パワードアキラ(対象キャラ)
#DIM 対象キャラ
;関数名に[]が使えないため、しょうがなく[]排除時の文字列をキーに
;例えば[強化状態二つ名]テスト太郎というスタイルなら、
;@スタイルステータス補正_強化状態二つ名_テスト太郎　という関数名にすること

;属性の変更、火とか水とか文字を変えるだけでOK
装備ステータス補正保存:対象キャラ:基礎属性変更 = 属性文字列数値変換("風") + 10
;ステータスの変更
装備ステータス補正保存:対象キャラ:防御力 += 100

;装備再計算時にこの関数は呼ばれる
;補正の順番は「スタイル＞指輪＞耳飾り＞料理など＞パーティキャラ補正」
;補正可能なステータスは「装備ステータス補正保存.ERD」を参照のこと


;--------------------------------------------------
;スタイル変更時、使用可能アビリティの変動
;--------------------------------------------------
;テンプレート「固有アビリティ_キャラ名.ERB」に記述する
;「@固有アビ_2223_任意の文字列(ARGS, キャラ番号)」の上部にある分岐を修正する

; IF スタイル判定関数(キャラ番号, "デフォルト") == 0
; を以下のように修正
; IF スタイル判定関数(キャラ番号, "<スタイル名>") == 0

;こうすることで、そのアビは<スタイル名>になっている時のみ使用可能という意味になる


;--------------------------------------------------
;スタイル変更時、使用可能奥義の変動
;--------------------------------------------------
;奥義はアビのように複数種類を使うことを想定していないため、別関数を呼ぶことを推奨。
;奥義テンプレにある以下の分岐のうち、任意のスタイル名の部分を編集した上で
;奥義テンプレをコピーして作成した関数に貼り付け、中身を記述する。

@固有奥義_2223(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名

IF CSTR:キャラ番号:スタイル管理文字列 == "[甦る外道魂]パワードアキラ"
	CALL 固有奥義_2223_パワードアキラ専用奥義(ARGS, キャラ番号)
	RETURN RESULT
ENDIF

IF TALENT:恋慕 || TALENT:セフレ || TALENT:非エロ陥落
	IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
		奥義名 = 破天無影蹴
		奥義威力 = 500
	ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
		奥義名 = 破の連舞＋
		奥義威力 = 450
	ELSE
		奥義名 = 破の連舞
		奥義威力 = 400
	ENDIF
ELSE
	奥義名 = 気功塊
	奥義威力 = 400
ENDIF

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 奥義名 == "破天無影蹴"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>後ろ向きの姿勢から勢いよくドロップキック。敵単体に土属性大ダメージ。
		ELSEIF 奥義名 == "破の連舞"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>突進から繰り出す乱舞技。敵単体に土属性大ダメージ。
		ELSEIF 奥義名 == "気功塊"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>至近距離から球状の気功を放ち、敵単体に土属性大ダメージ。
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる

		;処理の都合上、ここから奥義ダメージまでにリセットを噛ませてないため
		;必要な場合を除きここでリセット
		CALL アビ汎用変数文字列リセット
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		IF 奥義名 == "破天無影蹴"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 550
			CALL アビテンプレート_ダメージ処理_土属性
		ELSEIF 奥義名 == "破の連舞＋"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 450
			CALL アビテンプレート_ダメージ処理_土属性
		ELSEIF 奥義名 == "破の連舞"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 400
			CALL アビテンプレート_ダメージ処理_土属性
		ELSEIF 奥義名 == "気功塊"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 400
			CALL アビテンプレート_ダメージ処理_土属性
		ENDIF
ENDSELECT

@固有奥義_2223_パワードアキラ専用奥義(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名

IF TALENT:恋慕 || TALENT:セフレ || TALENT:非エロ陥落
	奥義名 = 破の双撃
	奥義威力 = 500
ELSE
	奥義名 = 剛気功塊
	奥義威力 = 400
ENDIF

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 奥義名 == "破の双撃"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>正拳打ちから始動する乱舞技。敵単体に風属性大ダメージ。
		ELSEIF 奥義名 == "剛気功塊"
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>至近距離から気功を放ち、敵単体に風属性大ダメージ。
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる

		;処理の都合上、ここから奥義ダメージまでにリセットを噛ませてないため
		;必要な場合を除きここでリセット
		CALL アビ汎用変数文字列リセット
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		IF 奥義名 == "破の双撃"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 500
			CALL アビテンプレート_ダメージ処理_風属性
		ELSEIF 奥義名 == "剛気候塊"
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 400
			CALL アビテンプレート_ダメージ処理_風属性
		ENDIF
ENDSELECT

;--------------------------------------------------
;キャラについての解説
;--------------------------------------------------
@口上_ステータス画面_キャラ解説_2223(対象キャラ)
;EXキャラの出典を解説したり、キャラの設定・背景を解説するもの
#DIM 対象キャラ

KSTR:(K++) = 　外道高校総番長・風間醍醐の妹。
KSTR:(K++) = 　以前は兄を救うべく男装して外道高校へ潜入したが、前回の事件後から聖純女学院に転校。
KSTR:(K++) = 　正義感の強い性格で手数が多い中国拳法を得意とする。
KSTR:(K++) = 　
KSTR:(K++) = 　誕生日：
KSTR:(K++) = 　好きな物：バイク・外道高校の仲間・一緒に戦った仲間
KSTR:(K++) = 　嫌いな物：喋ること
KSTR:(K++) = 　特技：中国拳法（陳氏太極拳）
KSTR:(K++) = 　
