
@固有奥義_37(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名

IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
	奥義名 = セレネ・ティモリア
	奥義威力 = 500
ELSE
	奥義名 = セレネ・ディーロシー
	奥義威力 = 450
ENDIF

;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>味方全体の奥義ゲージ［10％］アップ
			詳細文文字列受け渡し変数 += @"<br>月天・事象投影が発動する"
		ELSE
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
			WSTR:(K++) = アルルメイヤの月天！
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_敵全体_生者のみ
			IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
				アビ汎用変数:効果割合 = 700
			ELSE
				アビ汎用変数:効果割合 = RAND(200, 250)
			ENDIF
			CALL アビテンプレート_ダメージ処理_土属性
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 10
			アビ汎用変数:累積上限_割合 = 40
			アビ汎用変数:持続ターン = 6
			CALL アビテンプレート_不利効果_累積デバフ効果セット
			
			IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 属性与ダメージ_水
				アビ汎用文字列:バフ・デバフ対象能力 = 属性与ダメージ_水
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 6
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			WSTR:(K++) = アルルメイヤの事象投影！
			IF !(戦闘中カウント:戦闘行動キャラ:0 == 1 && 戦闘中カウント:戦闘行動キャラ:1 == 1 && 戦闘中カウント:戦闘行動キャラ:2 == 1 && 戦闘中カウント:戦闘行動キャラ:3 == 1)
				SELECTCASE RAND:4
					CASE 0
						IF 戦闘中カウント:戦闘行動キャラ:0 == 1
							RESTART
						ENDIF
						戦闘中カウント:戦闘行動キャラ:0 = 1
					CASE 1
						IF 戦闘中カウント:戦闘行動キャラ:1 == 1
							RESTART
						ENDIF
						戦闘中カウント:戦闘行動キャラ:1 = 1
					CASE 2
						IF 戦闘中カウント:戦闘行動キャラ:2 == 1
							RESTART
						ENDIF
						戦闘中カウント:戦闘行動キャラ:2 = 1
					CASE 3
						IF 戦闘中カウント:戦闘行動キャラ:3 == 1
							RESTART
						ENDIF
						戦闘中カウント:戦闘行動キャラ:3 = 1
				ENDSELECT
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:0 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = 追撃A
				アビ汎用文字列:バフ・デバフ対象能力 = 追撃
				アビ汎用変数:効果割合 = 30
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:1 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = DA率A
				アビ汎用文字列:バフ・デバフ対象能力 = DA率
				アビ汎用変数:効果量 = 100
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
			
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = TA率A
				アビ汎用文字列:バフ・デバフ対象能力 = TA率
				アビ汎用変数:効果量 = 50
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:2 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = クリティカル率A
				アビ汎用文字列:バフ・デバフ対象能力 = クリティカル率
				アビ汎用変数:効果量 = 100
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
				
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = クリティカルダメージ率A
				アビ汎用文字列:バフ・デバフ対象能力 = クリティカルダメージ率
				アビ汎用変数:効果量 = 30
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:3 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = 与ダメ増加A
				アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
				アビ汎用変数:効果割合 = 10
				アビ汎用変数:持続ターン = 4
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
		ENDIF
ENDSELECT
