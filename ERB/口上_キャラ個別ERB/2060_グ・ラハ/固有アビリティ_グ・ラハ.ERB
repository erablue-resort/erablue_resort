
@固有アビ_2060_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ラハ隊列

ラハ隊列 = キャラ隊列検索(GETCHARA(2060))
IF バフ存在判定_枠("コンボ：ロイヤルアソリティ",ラハ隊列) >= 0
	アビ名 = ディヴァインヴェール
	消費ＭＰ = 5
ELSEIF バフ存在判定_枠("コンボ：レイジ・オブ・ハルオーネ",ラハ隊列) >= 0
	アビ名 = レイジ・オブ・ハルオーネ
	消費ＭＰ = 5
ELSEIF バフ存在判定_枠("コンボ：ライオットソード",ラハ隊列) >= 0
	アビ名 = ライオットソード
	消費ＭＰ = 10
ELSE
	アビ名 = ファストブレード
	消費ＭＰ = 20
ENDIF

;すっげえわかりづらいと思うんですけど、バフを見てアビリティを変化させています
SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF バフ存在判定_枠("コンボ：ロイヤルアソリティ",ラハ隊列)
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に自属性の［４６０％］ダメージを与える。
		ELSEIF バフ存在判定_枠("コンボ：レイジ・オブ・ハルオーネ",ラハ隊列)
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に自属性の［４００％］ダメージを与える。
		ELSEIF バフ存在判定_枠("コンボ：ライオットソード",ラハ隊列)
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に自属性の［３３０％］ダメージを与える。
			IF 基礎BATTLE_STATE:キャラ番号:Lv <= 60
				詳細文文字列受け渡し変数 += @"<br>次のターンの間、このアビリティがロイヤルアソリティに変化する。"
			ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv <= 26
				詳細文文字列受け渡し変数 += @"<br>次のターンの間、このアビリティがレイジ・オブ・ハルオーネに変化する。"
			ELSE
			ENDIF
		ELSE
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に自属性の［２２０％］ダメージを与える。
		SIF 基礎BATTLE_STATE:キャラ番号:Lv <= 4
			詳細文文字列受け渡し変数 += @"<br>次のターンの間、このアビリティがライオットソードに変化する。"
		ENDIF

		RETURN 消費ＭＰ
	CASE "アビ効果"
		IF バフ存在判定_枠("コンボ：ロイヤルアソリティ",ラハ隊列)
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 460
			CALL アビテンプレート_ダメージ処理_自属性
		ELSEIF バフ存在判定_枠("コンボ：レイジ・オブ・ハルオーネ",ラハ隊列)
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 400
			CALL アビテンプレート_ダメージ処理_自属性
		ELSEIF バフ存在判定_枠("コンボ：ライオットソード",ラハ隊列)
				CALL アビ対象選択テンプレート_敵単体
				アビ汎用変数:効果割合 = 330
				CALL アビテンプレート_ダメージ処理_自属性
			IF 基礎BATTLE_STATE:キャラ番号:Lv <= 60
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_自己のみ
				アビ汎用変数:特殊表示オプション = 1
				アビ汎用変数:消去不可オプション = 1
				アビ汎用文字列:バフ・デバフ枠 = コンボ：ロイヤルアソリティ
				アビ汎用文字列:バフ・デバフ対象能力 = コンボ：ロイヤルアソリティ
				アビ汎用変数:持続ターン = 2
				CALL アビテンプレート_有利効果_バフ効果セット
			ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv <= 26
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_自己のみ
				アビ汎用変数:特殊表示オプション = 1
				アビ汎用変数:消去不可オプション = 1
				アビ汎用文字列:バフ・デバフ枠 = コンボ：レイジ・オブ・ハルオーネ
				アビ汎用文字列:バフ・デバフ対象能力 = コンボ：レイジ・オブ・ハルオーネ
				アビ汎用変数:持続ターン = 2
				CALL アビテンプレート_有利効果_バフ効果セット
			ELSE
			ENDIF
		ELSE
			CALL アビ対象選択テンプレート_敵単体
			アビ汎用変数:効果割合 = 220
			CALL アビテンプレート_ダメージ処理_自属性
			IF 基礎BATTLE_STATE:キャラ番号:Lv <= 4
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_自己のみ
				アビ汎用変数:特殊表示オプション = 1
				アビ汎用変数:消去不可オプション = 1
				アビ汎用文字列:バフ・デバフ枠 = コンボ：ライオットソード
				アビ汎用文字列:バフ・デバフ対象能力 = コンボ：ライオットソード
				アビ汎用変数:持続ターン = 2
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
		ENDIF
ENDSELECT

@固有アビ_2060_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ラハ隊列

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
	アビ名 = ディヴァインヴェール
	消費ＭＰ = 35
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 27
	アビ名 = アイアンウィル
	消費ＭＰ = 20
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 8
	アビ名 = ランパート
	消費ＭＰ = 10
ELSE
	アビ名 = 
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
	IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体の防御力を３０％/３Ｔ上昇させる。
		詳細文文字列受け渡し変数 += @"<br>さらに、味方全体に自身の最大ＨＰの３０％分のバリアを付与して５００回復する。"
	ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 27
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体の防御力を３０％/３Ｔ上昇させる。
		詳細文文字列受け渡し変数 += @"<br>さらに、味方全体に５００のバリアを付与する。"
	ELSE
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体の防御力を３０％/３Ｔ上昇させる。
	ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		ラハ隊列 = キャラ隊列検索(GETCHARA(2060))
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 56
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用変数:効果割合 = 30
			アビ汎用文字列:バフ・デバフ枠 = 防御力A
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット
			アビ汎用変数:効果量 = BATTLE_STATE:ラハ隊列:最大ＨＰ * 30 / 100
			アビ汎用文字列:バフ・デバフ枠 = ディヴァインヴェール
			アビ汎用文字列:バフ・デバフ対象能力 = バリア
			CALL アビテンプレート_有利効果_バフ効果セット
			アビ汎用変数:効果量 = 500
			CALL アビテンプレート_回復処理_MAXでも回復
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 27
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用変数:効果割合 = 30
			アビ汎用文字列:バフ・デバフ枠 = 防御力A
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット

			アビ汎用変数:効果量 = 500
			アビ汎用文字列:バフ・デバフ枠 = アイアンウィル
			アビ汎用文字列:バフ・デバフ対象能力 = バリア
			CALL アビテンプレート_有利効果_バフ効果セット
		ELSE
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用変数:効果割合 = 30
			アビ汎用文字列:バフ・デバフ枠 = 防御力A
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
ENDSELECT

@固有アビ_2060_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM ラハ隊列

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 560
	アビ名 = インビンシブル
	消費ＭＰ = 200
ELSE
	アビ名 = 
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体をかばい、自身にダメージカット１００％/１回を付与する
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = インビンシブル
		アビ汎用文字列:バフ・デバフ対象能力 = インビンシブル
		アビ汎用変数:持続ターン = 1
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		アビ汎用文字列:バフ・デバフ枠 = 無敵_インビンシブル
		アビ汎用変数:効果割合 = 100
		アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
		CALL アビテンプレート_有利効果_付随バフ効果セット("インビンシブル")

		アビ汎用文字列:バフ・デバフ枠 = かばう_インビンシブル
		アビ汎用文字列:バフ・デバフ対象能力 = 全体かばう
		CALL アビテンプレート_有利効果_付随バフ効果セット("インビンシブル")
ENDSELECT


@固有戦闘開始時処理_キャラ_2060
CALL アビ対象選択テンプレート_自己のみ
アビ汎用変数:効果量 = 200
アビ汎用文字列:バフ・デバフ枠 = タンクマスタリー
アビ汎用文字列:バフ・デバフ対象能力 = 敵対心
アビ汎用変数:持続ターン = -1
アビ汎用変数:消去不可オプション = 1
アビ汎用変数:特殊表示オプション = 1
CALL アビテンプレート_有利効果_バフ効果セット

@バフ・デバフ特殊表示_コンボ：ライオットソード(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS
PRINTFORML コンボ：ライオットソード
PRINTFORML ファストブレードがライオットソードに変化した状態。
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}

@バフ・デバフ特殊表示_コンボ：レイジ・オブ・ハルオーネ(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS
PRINTFORML コンボ：レイジ・オブ・ハルオーネ
PRINTFORML ライオットソードがレイジ・オブ・ハルオーネに変化した状態。
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}

@バフ・デバフ特殊表示_コンボ：ロイヤルアソリティ(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS
PRINTFORML コンボ：ロイヤルアソリティ
PRINTFORML ライオットソードがロイヤルアソリティに変化した状態。
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}

@バフ・デバフ特殊表示_タンクマスタリー(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS
PRINTFORML タンクマスタリー
PRINTFORML 敵視を大幅に高め、敵を引き付けやすくなる。
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}

@バフ・デバフ特殊表示_インビンシブル(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS
PRINTFORML インビンシブル＆かばう
PRINTFORML パーティメンバーが受ける攻撃を肩代わりする。
PRINTFORML 一定時間、自身への一部を除くすべてのダメージを無効化する。
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}
;--------------------------------------------------
;戦闘能力の固有処理説明
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_2060(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

;口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;基本的にWAIT系列は使わないことを推奨

KSTR:(K++) = □ 特性 □：『タンクマスタリー』 □-------------------------------------------------------------------------------
KSTR:(K++) = 敵の攻撃を引き付けやすい。
KSTR:(K++) = 　
KSTR:(K++) = 　
KSTR:(K++) = 　

CALL 口上変数表示(対象キャラ, 1)
